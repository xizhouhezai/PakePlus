import{k as j,r as z}from"./order-HsmDfkng.js";import{u as C}from"./filters-D05Q2eUM.js";import{a9 as Q}from"./tools-BfzgO_2s.js";import{R as W}from"./validator-B8pIxTAL.js";import{d as G,r as g,b8 as H,p as J,a as K,b as u,o as d,c as p,j as b,w as a,k as t,t as r,s as x,f as o,e as l,u as i,F as X,i as Z,q as h,M as R,_ as ee}from"./index-C4AMdMz2.js";import{u as te}from"./useCurrentInstance-BLlvmEjv.js";const se={relative:""},oe={"color-black":"","font-bold":""},ae={key:1},le={"my-20px":"",flex:"","gap-8px":"","flex-a-c":"",class:"info-item"},re={class:"price","font-bold":""},ne={"my-20px":"",flex:"","gap-8px":"","flex-a-c":"",class:"info-item"},ie={class:"price","font-bold":""},de={"my-20px":"",flex:"","gap-8px":"","flex-a-c":"",class:"info-item"},ue={class:"price","font-bold":""},fe={"my-20px":"",flex:"","gap-8px":"","flex-a-c":"",class:"info-item"},pe={"font-bold":""},me={key:0,flex:"","gap-8px":"","flex-a-c":""},ce={"mt-20px":"","overflow-hidden":""},ve={"my-20px":"",flex:"","gap-8px":"","flex-a-c":"",class:"info-item"},xe={class:"price","font-bold":""},_e={key:0,"my-20px":"",flex:"","gap-8px":"","flex-a-c":"",class:"info-item"},ye={class:"price","font-bold":""},ke={"my-20px":"",flex:"","gap-8px":"","flex-a-c":"",class:"info-item"},ge={"my-20px":"",flex:"","gap-8px":"","flex-a-c":"",class:"info-item"},be={"my-20px":"",flex:"","gap-8px":"","flex-a-c":"",class:"info-item"},Re={key:0,flex:"","gap-8px":"","flex-a-c":""},Se={"mt-20px":"","overflow-hidden":""},Ee={flex:"","flex-j-sb":"","flex-a-c":""},Ne={"mt-10px":"","color-gray":""},Pe={key:0},we={key:1},Te={style:{"text-align":"right"}},Ue=G({__name:"return-process",props:{res:null,orderInfo:null},emits:["reload"],setup(V,{emit:F}){var w;const s=V,S=F,_=g(!1),I=H("refoundForm"),M=(w=te().globalProperties)==null?void 0:w.$modal,m=g({remark:"",serviceStatus:"",actualRefundPrice:""}),c=g(!1),E=J(),k=K({data:{remark:""}});function N(f){m.value.actualRefundPrice=s.res.applyRefundPrice,m.value.serviceStatus=f,c.value=!0}async function P(){var e;if(_.value=!0,await((e=I.value)==null?void 0:e.validate()))_.value=!1;else try{(await j(E.query.id,m.value)).data.success&&(R.success("操作成功!"),S("reload"),c.value=!1)}catch(v){_.value=!1,console.warn(v)}}function O(){if(k.data.remark===""){R.error("请输入退款备注");return}M.confirm({title:"确认退款",content:"请确认退款？",alignCenter:!1,onOk:()=>{z(E.query.id,{remark:k.data.remark}).then(f=>{console.error(f),f.data.code===200&&(R.success("收款成功"),S("reload"))})}})}function $(){let f="";return Q.forEach(e=>{e.value===s.res.serviceStatus&&(f=e.label)}),f}return(f,e)=>{const v=u("a-typography-title"),T=u("a-input"),y=u("a-button"),A=u("a-tag"),Y=u("a-image"),D=u("a-divider"),U=u("a-form-item"),B=u("a-textarea"),q=u("a-form"),L=u("a-modal");return d(),p("div",se,[s.res?(d(),b(v,{key:0,heading:2},{default:a(()=>[t("div",oe,r($()),1)]),_:1})):x("",!0),s.res.serviceStatus==="WAIT_REFUND"?(d(),p("div",ae,[e[13]||(e[13]=t("h3",null,"平台退款",-1)),t("div",le,[e[7]||(e[7]=o(" 银行开户行 ")),t("span",re,r(s.res.bankDepositName),1)]),t("div",ne,[e[8]||(e[8]=o(" 银行开户名 ")),t("span",ie,r(s.res.bankAccountName),1)]),t("div",de,[e[9]||(e[9]=o(" 银行卡号 ")),t("span",ue,r(s.res.bankAccountNumber),1)]),t("div",null,[e[10]||(e[10]=o(" 审核备注 ")),t("span",null,[l(T,{modelValue:i(k).data.remark,"onUpdate:modelValue":e[0]||(e[0]=n=>i(k).data.remark=n),clearable:"",style:{width:"260px"}},null,8,["modelValue"])])]),t("div",fe,[e[12]||(e[12]=o(" 操作 ")),t("span",pe,[l(y,{onClick:e[1]||(e[1]=n=>O())},{default:a(()=>e[11]||(e[11]=[o(" 退款 ")])),_:1})])])])):x("",!0),t("div",null,[s.res.serviceStatus==="APPLY"?(d(),p("div",me,[l(y,{type:"primary",onClick:e[2]||(e[2]=n=>N("PASS"))},{default:a(()=>[o(" 同意"+r(s.res.serviceType==="RETURN_MONEY"?"退款":"退货"),1)]),_:1}),l(y,{onClick:e[3]||(e[3]=n=>N("REFUSE"))},{default:a(()=>[o(" 拒绝"+r(s.res.serviceType==="RETURN_MONEY"?"退款":"退货"),1)]),_:1})])):x("",!0)]),t("div",ce,[l(v,{heading:5},{default:a(()=>[e[14]||(e[14]=o(" 信息概览 ")),l(A,{"ml-10px":"",color:"arcoblue"},{default:a(()=>[o(r(s.orderInfo.deliverStatusValue)+r(s.res.serviceType==="RETURN_MONEY"?"退款":"退货"),1)]),_:1})]),_:1}),t("div",ve,[e[16]||(e[16]=t("div",null,"申请金额",-1)),t("div",xe,[e[15]||(e[15]=o(" ¥")),t("span",null,r(s.res.applyRefundPrice?i(C)(s.res.applyRefundPrice):"--"),1)])]),s.res.serviceStatus!=="REFUSE"?(d(),p("div",_e,[e[18]||(e[18]=o(" 实际退款金额 ")),t("span",ye,[e[17]||(e[17]=o(" ¥ ")),t("span",null,r(s.res.actualRefundPrice?i(C)(s.res.actualRefundPrice):"--"),1)])])):x("",!0),t("div",ke,[e[19]||(e[19]=t("div",null,"售后原因",-1)),t("div",null,r(s.res.reason),1)]),t("div",ge,[e[20]||(e[20]=t("div",null,"售后说明",-1)),t("div",null,r(s.res.problemDesc),1)]),t("div",be,[e[21]||(e[21]=t("div",null,"买家凭证",-1)),s.res.afterSaleImage?(d(),p("div",Re,[(d(!0),p(X,null,Z(s.res.afterSaleImage.split(","),n=>(d(),b(Y,{key:n,width:"100px",height:"100px",src:n},null,8,["src"]))),128))])):x("",!0)])]),l(D),t("div",Se,[t("div",Ee,[l(v,{heading:5},{default:a(()=>e[22]||(e[22]=[o(" 备注信息 ")])),_:1})]),t("div",Ne,[s.res.auditRemark?(d(),p("span",Pe,r(s.res.auditRemark),1)):(d(),p("span",we," 暂无备注"))])]),l(L,{visible:i(c),"onUpdate:visible":e[6]||(e[6]=n=>h(c)?c.value=n:null),"ok-loading":i(_),title:`${i(m).serviceStatus==="PASS"?"同意":"拒绝"}${s.res.serviceType==="RETURN_MONEY"?"退款":"退货"}`,width:"500px",closable:!1,onOk:P},{footer:a(()=>[t("div",Te,[l(y,{type:"text",onClick:e[5]||(e[5]=n=>c.value=!1)},{default:a(()=>e[24]||(e[24]=[o(" 取消 ")])),_:1}),l(y,{type:"primary",loading:i(_),onClick:P},{default:a(()=>e[25]||(e[25]=[o(" 确认 ")])),_:1},8,["loading"])])]),default:a(()=>[t("div",null,[l(q,{ref:"refoundForm",model:i(m),style:{width:"460px"},layout:"horizontal","auto-label-width":""},{default:a(()=>[s.res.serviceType==="RETURN_MONEY"?(d(),b(U,{key:0,label:"申请退款金额"},{default:a(()=>[l(T,{"default-value":Number(s.res.applyRefundPrice).toFixed(2),disabled:""},{prefix:a(()=>e[23]||(e[23]=[o(" ¥ ")])),_:1},8,["default-value"])]),_:1})):x("",!0),l(U,{field:"remark",label:"备注信息",rules:[i(W)]},{default:a(()=>[l(B,{modelValue:i(m).remark,"onUpdate:modelValue":e[4]||(e[4]=n=>i(m).remark=n)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])])]),_:1},8,["visible","ok-loading","title"])])}}}),$e=ee(Ue,[["__scopeId","data-v-ce587426"]]);export{$e as default};
