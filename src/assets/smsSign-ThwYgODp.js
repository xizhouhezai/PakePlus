import{u as V}from"./index--a7kHzzJ.js";import{d as M,r as c,J as T,p as D,n as z,a as I,h as $,b as n,o as q,j as J,w as a,e as s,u as l,f as u,k as p,M as r,b4 as Q,b5 as G,b6 as H,_ as K}from"./index-C4AMdMz2.js";import{R as L}from"./validator-B8pIxTAL.js";const O=M({__name:"smsSign",setup(W){const N=c(["jpg","jpeg","png","gif","bmp"]),_=c(T.getAccessToken()||""),R=D(),g=z(),b=c(),v=c(),S=c(),t=I({id:"",form:{signName:"",signSource:"",businessLicense:"",license:""}});function P(o){o.response.success&&(r.success("上传成功"),t.form.businessLicense=o.response.result)}function U(o){o.response.success&&(r.success("上传成功"),t.form.license=o.response.result)}const k=()=>{r.error("上传失败")},w=o=>new Promise((e,i)=>{N.value.includes(o.name.split(".")[o.name.split(".").length-1])?Number((o.size/1024).toFixed(0))>1024?(i(new Error("上传失败")),r.error("所选文件大小过大，不得超过1M")):e(!0):(i(new Error("上传失败")),r.error("请选择 .jpg .jpeg .png .gif .bmp格式文件"))});async function j(){var e;if(!await((e=b.value)==null?void 0:e.validate())){if(t.form.signSource===""){r.error("请选择签名来源！");return}if(!t.form.businessLicense||!t.form.license){r.error("请完善证件信息！");return}t.id?Q(t.form).then(i=>{i.data.success&&(r.success("修改成功！"),g.back())}):G(t.form).then(i=>{i.data.success&&(r.success("添加成功！"),g.back())})}}async function B(){const o=await H(t.id);o.data.success&&(t.form=o.data.result,o.data.result&&(v.value=o.data.result.businessLicense?[{url:o.data.result.businessLicense}]:[],S.value=o.data.result.license?[{url:o.data.result.license}]:[]))}return $(()=>{t.id=R.query.id,t.id&&B()}),(o,e)=>{const i=n("a-input"),d=n("a-form-item"),m=n("a-option"),A=n("a-select"),y=n("a-upload"),C=n("a-textarea"),x=n("a-button"),E=n("a-form"),F=n("a-card");return q(),J(F,{class:"general-card",title:l(t).id?"修改签名":"新增签名",bordered:!1},{default:a(()=>[s(E,{ref_key:"formRef",ref:b,model:l(t).form,layout:"horizontal","auto-label-width":""},{default:a(()=>[s(d,{field:"signName",label:"消息标题",rules:[l(L)]},{default:a(()=>[s(i,{modelValue:l(t).form.signName,"onUpdate:modelValue":e[0]||(e[0]=f=>l(t).form.signName=f),placeholder:"仅限2-12个字符，建议使用APP应用名称或是网站名/公司名",style:{width:"400px"}},null,8,["modelValue"])]),_:1},8,["rules"]),s(d,{field:"signSource",label:"签名来源",rulese:[l(L)]},{default:a(()=>[s(A,{modelValue:l(t).form.signSource,"onUpdate:modelValue":e[1]||(e[1]=f=>l(t).form.signSource=f),placeholder:"请选择签名来源",style:{width:"400px"}},{default:a(()=>[s(m,{value:0},{default:a(()=>e[5]||(e[5]=[u(" 企业单位的全称或简称 ")])),_:1}),s(m,{value:1},{default:a(()=>e[6]||(e[6]=[u(" 工信部备案网站的全称或简称 ")])),_:1}),s(m,{value:2},{default:a(()=>e[7]||(e[7]=[u(" App应用的全称或简称 ")])),_:1}),s(m,{value:3},{default:a(()=>e[8]||(e[8]=[u(" 公众号或小程序的全称或简称 ")])),_:1}),s(m,{value:4},{default:a(()=>e[9]||(e[9]=[u(" 电商平台店铺名的全称或简称 ")])),_:1}),s(m,{value:5},{default:a(()=>e[10]||(e[10]=[u(" 商标名的全称或简称 ")])),_:1})]),_:1},8,["modelValue"])]),_:1},8,["rulese"]),s(d,{label:""},{default:a(()=>e[11]||(e[11]=[p("div",{class:"tips"},[p("p",null," 签名来源选择工信部备案网站的全称或简称时，请在说明中添加网站域名，加快审核速度； "),p("p",null," 如果选择APP应用的全程或简称或公众号或小程序的全程或简称时，则网站、APP、小程序或公众号必须已上线； ")],-1)])),_:1}),s(d,{label:"证明文件",class:"form-item-pic"},{default:a(()=>[s(y,{"list-type":"picture-card",headers:{accessToken:l(_)},action:l(V),style:{marginRight:"10px"},"on-success":P,"on-error":k,limit:1,"file-list":l(v),"image-preview":"",onBeforeUpload:w},null,8,["headers","action","file-list"]),s(y,{"list-type":"picture-card",headers:{accessToken:l(_)},action:l(V),"on-success":U,"on-error":k,limit:1,"file-list":l(S),"image-preview":"",onBeforeUpload:w},null,8,["headers","action","file-list"])]),_:1}),s(d,{label:""},{default:a(()=>e[12]||(e[12]=[p("div",{class:"tips"},[p("p",null," 第一张为营业执照，第二张为授权委托书，请上传签名归属方的企事业单位的企业营业执照、组织机构代码证、税务登记证三证合一的证件及授权委托书 "),p("p",null,"支持jpg、png、gif、jpeg格式的图片，每张图片不大于2MB")],-1)])),_:1}),s(d,{field:"remark",label:"申请说明"},{default:a(()=>[s(C,{modelValue:l(t).form.remark,"onUpdate:modelValue":e[2]||(e[2]=f=>l(t).form.remark=f),"allow-clear":"",style:{width:"400px"}},null,8,["modelValue"])]),_:1}),s(d,{label:""},{default:a(()=>[s(x,{style:{"margin-right":"10px"},onClick:e[3]||(e[3]=f=>l(g).go(-1))},{default:a(()=>e[13]||(e[13]=[u(" 返回 ")])),_:1}),s(x,{type:"primary",onClick:e[4]||(e[4]=f=>j())},{default:a(()=>e[14]||(e[14]=[u(" 提交 ")])),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["title"])}}}),h=K(O,[["__scopeId","data-v-40215dfd"]]);export{h as default};
