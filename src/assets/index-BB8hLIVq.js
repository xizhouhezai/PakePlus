import{d as J,r as c,h as j,b as f,o as k,j as U,w as o,e as l,f as p,k as F,u as a,s as K,q as P,bo as x,bp as $,M as y,bq as z,br as G}from"./index-C4AMdMz2.js";import{u as H}from"./useCurrentInstance-BLlvmEjv.js";const Q={class:"flex"},Z=J({__name:"index",setup(W){var _;const V=c([]),g=c(!1),b=(_=H().globalProperties)==null?void 0:_.$modal,t=c({enableAddModal:!1,formLoading:!1,fid:"",form:{adCode:"",cityCode:"",center:"",name:"",orderNum:"",level:"",enable:!1}}),d=c({parentName:"",adCode:"",cityCode:"",name:"",orderNum:"",center:"",level:""});function B(r,e){e.node.cityCode==="null"&&(e.node.cityCode=""),t.value.form=e.node}async function C(){const e=await x(0);e.data.success&&e.data.result.forEach(u=>{let i;u.name==="台湾省"?i={...u,title:u.name,key:u.id,isLeaf:!0}:i={...u,title:u.name,loading:!1,children:[],key:u.id},V.value.push(i)})}const w=r=>{x(r.id).then(e=>{if(e.data.result.length<=0)return!1;e.data.result.forEach(u=>{let i;r.label==="district"||u.level==="street"||r.label==="香港特别行政区"||r.label==="澳门特别行政区"?(i={...u,title:u.name,key:u.id,isLeaf:!0},delete u.children):i={...u,title:u.name,loading:!1,children:[],key:u.id},r.children.push(i)})})};function L(){b.confirm({title:"确定更新？",content:"更新后店铺以及用户地区绑定数据将全部错乱",alignCenter:!1,onOk:async()=>{}})}function R(){delete t.value.form.createBy,delete t.value.form.createTime,delete t.value.form.updateBy,delete t.value.form.updateTime,$(t.value.form.id,t.value.form).then(r=>{r.data.result&&y.success("修改成功!,请稍后查看数据")})}function T(){b.confirm({title:"确认删除",content:"删除后店铺以及用户地区绑定数据将全部错乱?",alignCenter:!1,onOk:async()=>{(await z(t.value.form.id)).data.success&&(y.success("删除成功!,请稍后查看数据"),C())}})}function M(){if(!t.value.form.parentId){y.error("请选择要添加的数据");return}d.value=JSON.parse(JSON.stringify(t.value.form));const r=["country","province","city","district","street"];let e="";r.forEach((u,i)=>{d.value.level===u&&(i===r.length-1?e=r[i-1]:e=r[i+1])}),d.value.level=e,d.value.parentId=t.value.form.id,d.value.parentName=t.value.form.name,delete d.value.id,delete d.value.createBy,delete d.value.createTime,delete d.value.updateBy,delete d.value.updateTime,delete d.value.selected,d.value.name="",d.value.center="",g.value=!0}function O(){delete d.value.children,G(d.value).then(r=>{r.data.success&&y.success("添加成功!请稍后查看")})}return j(()=>{C()}),(r,e)=>{const u=f("a-button"),i=f("a-space"),I=f("a-col"),S=f("a-tree"),s=f("a-input"),m=f("a-form-item"),v=f("a-radio"),E=f("a-radio-group"),N=f("a-form"),q=f("a-modal"),A=f("a-card");return k(),U(A,{class:"general-card",title:"行政地区",bordered:!1},{default:o(()=>[l(I,{span:16,style:{"margin-bottom":"10px"}},{default:o(()=>[l(i,null,{default:o(()=>[l(u,{type:"primary",onClick:L},{default:o(()=>e[13]||(e[13]=[p(" 同步数据 ")])),_:1})]),_:1})]),_:1}),F("div",Q,[l(S,{data:a(V),"load-more":w,style:{width:"400px"},"h-600px":"","overflow-y-auto":"","default-expand-selected":!0,"default-expand-checked":!0,onSelect:B},null,8,["data"]),l(N,{model:a(t).form},{default:o(()=>[a(t).form.adCode?(k(),U(m,{key:0,field:"adCode",label:"区域编码","validate-trigger":["change"]},{default:o(()=>[l(s,{modelValue:a(t).form.adCode,"onUpdate:modelValue":e[0]||(e[0]=n=>a(t).form.adCode=n)},null,8,["modelValue"])]),_:1})):K("",!0),l(m,{field:"cityCode",label:"城市代码","validate-trigger":["change"]},{default:o(()=>[l(s,{modelValue:a(t).form.cityCode,"onUpdate:modelValue":e[1]||(e[1]=n=>a(t).form.cityCode=n)},null,8,["modelValue"])]),_:1}),l(m,{field:"level",label:"行政区划级别","validate-trigger":["change"]},{default:o(()=>[l(E,{modelValue:a(t).form.level,"onUpdate:modelValue":e[2]||(e[2]=n=>a(t).form.level=n),type:"button",disabled:""},{default:o(()=>[l(v,{value:"country"},{default:o(()=>e[14]||(e[14]=[p(" 国家 ")])),_:1}),l(v,{value:"province"},{default:o(()=>e[15]||(e[15]=[p(" 省份 ")])),_:1}),l(v,{value:"city"},{default:o(()=>e[16]||(e[16]=[p(" 市 ")])),_:1}),l(v,{value:"district"},{default:o(()=>e[17]||(e[17]=[p(" 区县 ")])),_:1}),l(v,{value:"street"},{default:o(()=>e[18]||(e[18]=[p(" 街道 ")])),_:1})]),_:1},8,["modelValue"])]),_:1}),l(m,{field:"center",label:"经纬度","validate-trigger":["change"]},{default:o(()=>[l(s,{modelValue:a(t).form.center,"onUpdate:modelValue":e[3]||(e[3]=n=>a(t).form.center=n)},null,8,["modelValue"])]),_:1}),l(m,{field:"name",label:"名称","validate-trigger":["change"]},{default:o(()=>[l(s,{modelValue:a(t).form.name,"onUpdate:modelValue":e[4]||(e[4]=n=>a(t).form.name=n)},null,8,["modelValue"])]),_:1}),l(m,{field:"cityCode",label:"排序","validate-trigger":["change"]},{default:o(()=>[l(s,{modelValue:a(t).form.orderNum,"onUpdate:modelValue":e[5]||(e[5]=n=>a(t).form.orderNum=n)},null,8,["modelValue"])]),_:1}),l(m,{label:"操作"},{default:o(()=>[l(u,{style:{"margin-right":"10px"},type:"primary",loading:a(t).formLoading,"html-type":"submit",onClick:M},{default:o(()=>e[19]||(e[19]=[p(" 添加 ")])),_:1},8,["loading"]),l(u,{style:{"margin-right":"10px"},loading:a(t).formLoading,"html-type":"submit",onClick:R},{default:o(()=>e[20]||(e[20]=[p(" 修改 ")])),_:1},8,["loading"]),l(u,{type:"primary",status:"danger",loading:a(t).formLoading,"html-type":"submit",onClick:T},{default:o(()=>e[21]||(e[21]=[p(" 删除 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"]),l(q,{visible:a(g),"onUpdate:visible":e[12]||(e[12]=n=>P(g)?g.value=n:null),title:"添加",onOk:O},{default:o(()=>[l(N,{model:a(d)},{default:o(()=>[l(m,{label:"父级"},{default:o(()=>[l(s,{modelValue:a(d).parentName,"onUpdate:modelValue":e[6]||(e[6]=n=>a(d).parentName=n),disabled:""},null,8,["modelValue"])]),_:1}),l(m,{field:"adCode",label:"区域编码"},{default:o(()=>[l(s,{modelValue:a(d).adCode,"onUpdate:modelValue":e[7]||(e[7]=n=>a(d).adCode=n)},null,8,["modelValue"])]),_:1}),l(m,{label:"城市代码",field:"cityCode"},{default:o(()=>[l(s,{modelValue:a(d).cityCode,"onUpdate:modelValue":e[8]||(e[8]=n=>a(d).cityCode=n)},null,8,["modelValue"])]),_:1}),l(m,{label:"经纬度",field:"center"},{default:o(()=>[l(s,{modelValue:a(d).center,"onUpdate:modelValue":e[9]||(e[9]=n=>a(d).center=n)},null,8,["modelValue"])]),_:1}),l(m,{label:"名称",field:"name"},{default:o(()=>[l(s,{modelValue:a(d).name,"onUpdate:modelValue":e[10]||(e[10]=n=>a(d).name=n)},null,8,["modelValue"])]),_:1}),l(m,{label:"排序",field:"orderNum"},{default:o(()=>[l(s,{modelValue:a(d).orderNum,"onUpdate:modelValue":e[11]||(e[11]=n=>a(d).orderNum=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])]),_:1})}}});export{Z as default};
