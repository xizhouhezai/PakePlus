import{f as R,h as E}from"./promotion-ChRoyrm_.js";import{u as $}from"./useCurrentInstance-BLlvmEjv.js";import{u as J}from"./filters-D05Q2eUM.js";import{G as B}from"./tools-BfzgO_2s.js";import{U as G,V as L}from"./dist-PezRi_EG.js";import{d as M,n as O,r as m,b as i,o as c,j as p,w as a,e as o,u as s,f as l,t as f,k as A,M as K}from"./index-C4AMdMz2.js";const Q=M({__name:"list",setup(U){var w;const y=O(),g=m(),k=m("START"),r=m({sort:"createTime",promotionStatus:k.value}),C=(w=$().globalProperties)==null?void 0:w.$modal,S=[{label:"商品名称",model:"goodsName",disabled:!1,input:!0},{label:"活动时间",model:"selectDate",disabled:!1,datePicker:{type:"range"}}],v=[{title:"商品名称",dataIndex:"goodsName",slot:!0,width:300,slotData:{goods:{goodsImage:"thumbnail",goodsName:"goodsName"}}},{title:"库存数量",dataIndex:"stock",width:100},{title:"剩余活动库存",dataIndex:"stock",width:100},{title:"每人最低砍",dataIndex:"lowestPrice",width:150,currency:!0},{title:"每人最高砍",dataIndex:"highestPrice",width:150,currency:!0},{title:"结算价格",dataIndex:"settlementPrice",width:100,currency:!0},{title:"活动时间",width:400,ellipsis:!1,dataIndex:"startTime",slot:!0,slotTemplate:"time"},{title:"状态",dataIndex:"promotionStatus",width:100,slot:!0,slotData:{badge:B}}],T={title:"操作",width:260,methods:[{title:"操作",callback:"action",slot:!0,slotTemplate:"action"}]};function _(d){C.confirm({title:"确认删除",content:"确认需要删除此砍价商品?",alignCenter:!1,onOk:async()=>{(await E(d.id)).data.success&&(K.success("删除成功"),g.value.init())}})}function h(){y.push({name:"add-kanJia-activity-goods"})}function b(d,t){const n={id:d.id,onlyView:"false"};n.onlyView=t==="onlyView",y.push({name:"edit-kanJia-activity-goods",query:n})}return(d,t)=>{const n=i("a-tab-pane"),I=i("a-tabs"),u=i("a-button"),N=i("a-space"),P=i("a-col"),V=i("a-row"),D=i("a-card");return c(),p(D,{class:"general-card",title:"砍价活动",bordered:!1},{default:a(()=>[o(I,{"default-active-key":s(k),onChange:t[0]||(t[0]=e=>{s(r).promotionStatus=e})},{default:a(()=>[o(n,{key:"NEW",title:"未开始"}),o(n,{key:"START",title:"已开始"}),o(n,{key:"END",title:"已结束"}),o(n,{key:"CLOSE",title:"已关闭"})]),_:1},8,["default-active-key"]),o(s(G),{columns:S,"time-type":"timestamp",onReset:t[1]||(t[1]=e=>{r.value={...s(r),...e}}),onSearch:t[2]||(t[2]=e=>{r.value={...s(r),...e}})}),o(V,{style:{"margin-bottom":"16px"}},{default:a(()=>[o(P,{span:16},{default:a(()=>[o(N,null,{default:a(()=>[o(u,{type:"primary",onClick:h},{default:a(()=>t[3]||(t[3]=[l(" 添加砍价 ")])),_:1})]),_:1})]),_:1})]),_:1}),o(s(L),{ref_key:"tablePageRef",ref:g,columns:v,methods:T,api:s(R),"api-params":s(r),bordered:!0,onDelete:_},{price:a(({data:e})=>[l(f(e.price?s(J)(e.price,"¥"):`${e.couponDiscount||0}折`),1)]),time:a(({data:e})=>[l(f(e.startTime),1),t[4]||(t[4]=A("span",{style:{margin:"0 10px"}},"-",-1)),l(f(e.endTime),1)]),action:a(({data:e})=>[e.promotionStatus==="CLOSE"||e.promotionStatus==="NEW"?(c(),p(u,{key:0,type:"text",status:"warning",style:{"margin-right":"10px"},onClick:x=>b(e)},{default:a(()=>t[5]||(t[5]=[l(" 编辑 ")])),_:2},1032,["onClick"])):(c(),p(u,{key:1,type:"text",status:"success",style:{"margin-right":"10px"},onClick:x=>b(e,"onlyView")},{default:a(()=>t[6]||(t[6]=[l(" 查看 ")])),_:2},1032,["onClick"])),o(u,{type:"text",status:"danger",onClick:x=>_(e)},{default:a(()=>t[7]||(t[7]=[l(" 删除 ")])),_:2},1032,["onClick"])]),_:1},8,["api","api-params"])]),_:1})}}});export{Q as default};
