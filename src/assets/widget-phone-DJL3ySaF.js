import{d as le,as as ne,r as v,p as ie,at as pe,U as ue,E as ce,h as M,b as x,v as fe,o as r,c,x as J,u as s,j as g,w as y,f as A,t as L,s as d,k as m,F as R,i as j,e as O,q as me,au as ve,M as W,ai as de,Z as F,C as _e,ak as B,_ as ye}from"./index-C4AMdMz2.js";import{I as ge}from"./all-BUr7x5Dn.js";import{u as he}from"./useDrop-BbPs1LL9.js";import{g as xe,n as D}from"./base-D-eA27UG.js";import{a as De,b as be,c as we,d as Ae,e as Oe}from"./user-D9IBgMMx.js";import{_ as Te}from"./tpl_banner.vue_vue_type_script_setup_true_lang-DmiVK4Fm.js";import{_ as Ne}from"./tpl_block.vue_vue_type_script_setup_true_lang-CgVNwhrh.js";import ke from"./tpl_flex_five-B5kc7BxV.js";import Ce from"./tpl_flex_four-D_DZr7yc.js";import Ee from"./tpl_flex_three-CKIaHVZc.js";import Se from"./tpl_flex_two-CnEGShJj.js";import{_ as Ie}from"./tpl_goods_detail.vue_vue_type_script_setup_true_lang-Cay-RjPK.js";import $e from"./tpl_goods_group-D4YbMfVH.js";import qe from"./tpl_goods_only-DEAIWKPE.js";import Pe from"./tpl_hot_area-TEVwSeBl.js";import Me from"./tpl_left_one_right_two-vc6gNro2.js";import Je from"./tpl_left_two_right_one-BGY7Wx8I.js";import{_ as Le}from"./tpl_line.vue_vue_type_script_setup_true_lang-B5sZSglN.js";import Re from"./tpl_menu-DpIQEhr7.js";import je from"./tpl_one-cv5pBO-I.js";import We from"./tpl_promotion_coupon-CEt1x7RJ.js";import Fe from"./tpl_search-C-6k9Sx8.js";import{_ as Be}from"./tpl_seckill.vue_vue_type_script_setup_true_lang-CnM60jut.js";import Ue from"./tpl_text-MJ8JI5TH.js";import Ve from"./tpl_user_ad-Cz032XbD.js";import{_ as Xe}from"./tpl_user_asset.vue_vue_type_script_setup_true_lang-ByJqb5dy.js";import ze from"./tpl_user_menu-NHPG23OT.js";import{_ as Ge}from"./tpl_user_order.vue_vue_type_script_setup_true_lang-zSJZ7hHM.js";import He from"./tpl_user_panel-Ca0VVpEb.js";import Ze from"./tpl_video-D1i31cTH.js";import{_ as Ke}from"./tpl_system_navbar.vue_vue_type_script_setup_true_lang-DbbdZm2K.js";import U from"./item-9tASDfuV.js";import{u as Qe}from"./index-B0S7r7AY.js";import"./useDrag-BGaSN1AF.js";import"./filters-D05Q2eUM.js";import"./tool-BVjb370d.js";import"./promotion-ChRoyrm_.js";import"./navigate-user-CJnyLpif.js";import"./assetsImages-DUrhbhdO.js";const Ye={whiteSpace:Ne,flexOne:je,flexHotArea:Pe,search:Fe,carousel:Te,goodsOnly:qe,menu:Re,leftOneRightTwo:Me,leftTwoRightOne:Je,flexTwo:Se,flexThree:Ee,flexFour:Ce,flexFive:ke,line:Le,text:Ue,userCenter:He,userMenuList:ze,userOrder:Ge,userAd:Ve,userAsset:Xe,coupon:We,video:Ze,seckill:Be,goodsGroup:$e,goodsDetail:Ie},et={class:"phone",flex:"","justify-center":"","flex-j-c":"","flex-a-c":""},tt={class:"model"},ot={class:"div-box"},st={"h-full":"",class:"phone-model"},at={key:0,flex:"","cursor-pointer":"","flex-j-c":"","flex-a-c":"","text-16px":"","font-bold":"",class:"wechat-navbar"},rt={key:1},lt={key:1,absolute:"","right--45px":"","top-0":"","z-99":""},nt={flex:"","flex-col":"","cursor-pointer":"","flex-j-c":"","flex-a-c":"",shadow:""},it=["onClick"],pt=le({__name:"widget-phone",setup(ut){const f=Qe(),[V,X]=he(()=>({accept:"box",drop:a=>te(a),collect:a=>({isOver:a.isOver(),canDrop:a.canDrop(),getItemType:a.getItemType(),isShallowOver:a.isOver({shallow:!0})})})),{canDrop:z,isOver:T}=ne(V),N=["whiteSpace","carousel"],k=v(0),C=v(0),i=ie(),[G]=pe(),h=v(!1),H=Ye,e=v([]),u=v(""),Z=ue(()=>!!s(z)),E=["goodsDetail"];ce(()=>f.indexOfApp,a=>{u.value=a});const b=v({data:{name:""},index:0}),K=v([{label:"向上移动",value:"up",icon:"up"},{label:"向下移动",value:"down",icon:"down"},{label:"置底",value:"double-down",icon:"double-down"},{label:"复制",value:"copy",icon:"copy"},{label:"删除",value:"delete",icon:"delete"}]);function Q(a,t,o){switch(a.value){case"up":{let l;i.query.pageType==="INDEX_WAP"?l=o>1:l=o>0,l&&B(()=>{[e.value[o-1],e.value[o]]=[e.value[o],e.value[o-1]],f.setAppActiveIndex(o-1)})}break;case"down":o<e.value.length-1&&B(()=>{[e.value[o],e.value[o+1]]=[e.value[o+1],e.value[o]],f.setAppActiveIndex(o+1)});break;case"double-down":e.value.splice(o,1),e.value.push(JSON.parse(JSON.stringify(t))),f.setAppActiveIndex(e.value.length-1),W.success("置底成功");break;case"copy":e.value.splice(o+1,0,JSON.parse(JSON.stringify(t)));break;case"delete":b.value={data:t,index:o},h.value=!0;break}}M(()=>{u.value=e.value.length===0?0:"",f.setAppActiveIndex(Number(u.value)),f.setAppDesign(e.value)});function Y(a,t){const o=e.value[a];e.value.splice(a,1),e.value.splice(t,0,o),u.value=t,f.setAppActiveIndex(t)}function ee(){e.value.splice(b.value.index,1)}function S(a,t){u.value=t,f.setAppActiveIndex(t)}function te(a){const t={...JSON.parse(JSON.stringify(a))};(!e.value.length||e.value[0].type==="systemNavbar")&&e.value.length===1||C.value===e.value.length-1?e.value.push(t):e.value.splice(k.value,0,t)}function oe(a,t){for(const o in t)a.hasOwnProperty(o)||(a[o]=t[o]);return a}async function se(){var o;if(i.query.pageType==="USER_CENTER_WAP"&&!i.query.id){const l=[De,be,we,Ae,Oe];e.value.push(...l)}if(i.query.pageType==="GOODS_DETAIL_TEMPLATE"&&e.value.push(xe),!i.query.id&&i.query.pageType==="INDEX_WAP")return e.value.push(D),!1;const a=i.query.id,t=await ve(a);if(t.data.success){const l=t.data.result.pageData?JSON.parse(t.data.result.pageData):"";if(l)if((l==null?void 0:l.version)==="v3"){if(e.value=l.data,((o=i.query)==null?void 0:o.pageType)==="INDEX_WAP"){if(e.value.length&&e.value[0].type!=="systemNavbar")e.value.unshift(D);else if(e.value.length&&e.value[0].type==="systemNavbar"){const w=JSON.parse(JSON.stringify(D));oe(w,D)}}f.setAppDesign(l.data)}else W.error({content:"当前编辑内容版本不支持",duration:1e4,closable:!0})}}return M(()=>{se()}),(a,t)=>{var $,q,P;const o=x("a-alert"),l=x("a-tag"),w=x("a-tooltip"),ae=x("a-modal"),I=fe("auto-animate");return r(),c("div",et,[J((r(),c("div",tt,[s(Z)?(r(),g(o,{key:0,class:"tips",type:s(T)?"success":"info"},{default:y(()=>[A(L(s(T)?"干的不错👏":"拖拽进此处👇"),1)]),_:1},8,["type"])):d("",!0),m("div",{ref:s(G)},[J((r(),c("div",{ref:s(X),"h-800px":"","px-13px":"","py-50px":"",role:"phone"},[m("div",ot,[m("div",st,[(($=s(i).query)==null?void 0:$.pageType)==="USER_CENTER_WAP"?(r(),c("div",at," 个人中心 ")):d("",!0),((q=s(i).query)==null?void 0:q.pageType)==="GOODS_DETAIL_TEMPLATE"?(r(),c("div",rt,t[3]||(t[3]=[m("div",{flex:"","cursor-pointer":"","flex-j-c":"","flex-a-c":"","text-16px":"","font-bold":"",class:"wechat-navbar"}," 商品页模版 ",-1),m("div",{"h-150px":"",flex:"","flex-col":"","flex-j-c":"","flex-a-c":"","bg-cyan-50":"","py-20px":"","color-cyan":""},[m("div",null,"商品基本区"),m("div",{"mt-8px":""}," 固定样式，显示商品主图、价格等信息 ")],-1)]))):d("",!0),s(e).length&&((P=s(i).query)==null?void 0:P.pageType)==="INDEX_WAP"?(r(),g(Ke,{key:2,res:s(e)[0],onClick:t[0]||(t[0]=n=>S(s(e)[0],0))},null,8,["res"])):d("",!0),(r(!0),c(R,null,j(s(e),(n,p)=>(r(),c("div",{key:p},[s(e).length?(r(),g(U,{key:0,id:U.type+new Date().getTime(),"move-card":Y,index:p,class:F(["model-item",{active:s(u)===p}]),absolute:"",onDragenter:_=>C.value=p,onDrop:_=>k.value=p,onClick:_=>S(n,p)},{default:y(()=>[s(u)===p&&!E.includes(n.type)?(r(),g(l,{key:0,class:"current",absolute:"",color:"arcoblue"},{default:y(()=>t[4]||(t[4]=[A(" 当前 ")])),_:1})):d("",!0),(r(),g(de(s(H)[n.type]),{class:F([{"compatible-border":s(u)===p&&N.includes(n.type),"border-around":s(u)===p&&!N.includes(n.type)},"component"]),res:n},null,8,["class","res"])),s(u)===p&&!E.includes(n.type)?(r(),c("div",lt,[m("div",nt,[(r(!0),c(R,null,j(s(K),(_,re)=>(r(),c("div",{key:re,"h-35px":"","w-35px":"",flex:"","flex-j-c":"","flex-a-c":"","bg-white":"",onClick:_e(ct=>Q(_,n,p),["stop"])},[O(w,{position:"bottom",content:_.label},{default:y(()=>[O(s(ge),{transition:"","hover:scale-130":"",type:_.icon,size:"18",fill:"#666"},null,8,["type"])]),_:2},1032,["content"])],8,it))),128))])])):d("",!0)]),_:2},1032,["id","index","class","onDragenter","onDrop","onClick"])):d("",!0)]))),128))])])])),[[I]])],512)])),[[I]]),O(ae,{visible:s(h),"onUpdate:visible":t[1]||(t[1]=n=>me(h)?h.value=n:null),"unmount-on-close":"",onOk:t[2]||(t[2]=n=>ee())},{title:y(()=>t[5]||(t[5]=[A(" 提示 ")])),default:y(()=>[m("div",null," 确认要删除模块 "+L(s(b).data.name)+" 吗？ ",1)]),_:1},8,["visible"])])}}}),Kt=ye(pt,[["__scopeId","data-v-d51f5fbd"]]);export{Kt as default};
