import{x as Y}from"./goods-CB7YWqUH.js";import{u as U}from"./filters-D05Q2eUM.js";import{m as ee,f as oe,g as te}from"./tools-BfzgO_2s.js";import{U as se}from"./dist-PezRi_EG.js";import ae from"./draw-goods-BT82c4ZQ.js";import{d as le,r as m,b as d,v as ne,o as c,c as h,e as n,w as i,f as v,k as e,u as r,x as D,F as M,i as R,j as E,Z as ie,t as p,s as de,M as ce,_ as re}from"./index-C4AMdMz2.js";import"./useDrag-BGaSN1AF.js";import"./useDrop-BbPs1LL9.js";const ue={flex:""},pe={"w-660px":"","px-8px":""},_e={"mt-20px":""},fe={class:"goods-col"},me={flex:""},ve={"ml-10px":""},xe={"w-150px":""},he={class:"goods-name"},ge={"text-12px":"","color-warmGray":""},ke={"w-306px":"","px-8px":"",class:"choose-goods-list"},be={class:"checked-goods-list"},ye={flex:""},we={"ml-10px":""},Ce={"w-170px":""},Ee={class:"goods-name"},Pe={"text-15px":"","color-red":"","font-600":""},Ne={"text-12px":"","color-gray":""},Ge={"text-right":""},je={flex:"","flex-j-sb":"","flex-a-c":""},Se={"w-660px":"",flex:"","flex-justify-end":"","flex-a-c":""},Ue=le({__name:"choose-goods",props:{templateModel:{type:String,default:"normal"},res:{type:null},bind:{type:null},max:{type:null,default:""}},emits:["callback"],setup(B,{expose:T,emit:V}){const u=B,z=V,g=m({pageNumber:1,pageSize:12,sort:"createTime",order:"desc"}),a=m([]),w=m(!1),_=m([]),P=m(0),$=[{label:"商品名称",model:"goodsName",disabled:!1,input:!0},{label:"状态",model:"marketEnable",disabled:!1,select:{options:ee}},{label:"销售模式",model:"salesModel",disabled:!1,select:{options:oe}},{label:"商品类型",model:"goodsType",disabled:!1,select:{options:te}},{label:"商品编号",model:"id",disabled:!1,input:!0}],k=m(!1);function F(){k.value=!0,b(),a.value=u.res.data[u.bind||"list"]}T({open:F});function N(){k.value=!1,q()}function G(){k.value=!1}function L(s,o){_.value.forEach(l=>{l.id===s.id&&(l._checked=!1)}),a.value.length&&a.value.splice(o,1)}function O(){_.value.forEach(s=>{a.value.forEach(o=>{s.id===o.id&&(s._checked=!1)})}),a.value=[]}function q(){z("callback",a.value)}function A(s){if(u.max&&!s._checked&&a.value.length>=u.max){ce.error(`最多只能选择${u.max}个商品`);return}s._checked=!s._checked,a.value.length&&a.value.some(l=>l.id===s.id)||a.value.push(s),s._checked||(a.value=a.value.filter(o=>o.id!==s.id))}function Z(s){g.value.pageNumber=s,b()}function H(s,o){const l=a.value[s];a.value.splice(s,1),a.value.splice(o,0,l)}async function b(s){_.value=[],s&&(g.value={...g.value,...s}),w.value=!1;const o=await Y(g.value);if(w.value=!0,o.data.success){P.value=o.data.result.total;const l=o.data.result.records;l.length&&(a.value.length?(a.value.forEach(f=>{l.forEach(y=>{f.id===y.id&&(y._checked=!0)})}),_.value=l):_.value=l.map(f=>({...f,_checked:!1})))}}return(s,o)=>{const l=d("a-image"),f=d("a-badge"),y=d("a-col"),I=d("a-row"),J=d("a-spin"),j=d("a-alert"),C=d("a-button"),K=d("a-pagination"),Q=d("a-space"),W=d("a-drawer"),S=ne("auto-animate");return c(),h("div",null,[n(W,{width:966,visible:r(k),"unmount-on-close":"",onOk:N,onCancel:G},{title:i(()=>o[2]||(o[2]=[v(" 添加商品 ")])),footer:i(()=>[e("div",je,[e("div",Se,[n(K,{total:r(P),"show-total":"",onChange:Z},null,8,["total"])]),n(Q,null,{default:i(()=>[n(C,{onClick:G},{default:i(()=>o[6]||(o[6]=[v(" 取消 ")])),_:1}),n(C,{type:"primary",onClick:N},{default:i(()=>o[7]||(o[7]=[v(" 确定 ")])),_:1})]),_:1})])]),default:i(()=>[e("div",ue,[D((c(),h("div",pe,[n(r(se),{"row-span":12,columns:$,onReset:o[0]||(o[0]=t=>{b(t)}),onSearch:o[1]||(o[1]=t=>{b(t)})}),e("div",null,[e("div",_e,[n(J,{loading:!r(w),"w-full":""},{default:i(()=>[e("div",fe,[n(I,{"col-gap":12,gutter:8},{default:i(()=>[(c(!0),h(M,null,R(r(_),(t,x)=>(c(),E(y,{key:x,"mt-10px":"",span:12,onClick:X=>A(t)},{default:i(()=>[e("div",{class:ie([{checked:t._checked},"goods-item"]),flex:"","cursor-pointer":"","flex-a-c":"","px-6px":""},[e("div",me,[e("div",null,[n(l,{src:t.thumbnail||t.small||"https://lili-system.oss-cn-beijing.aliyuncs.com/img.png",width:"75",height:"75"},null,8,["src"])]),e("div",ve,[e("div",xe,[e("div",he,p(t.goodsName),1),e("div",null,[n(f,{status:t.marketEnable==="UPPER"?"success":"danger",text:t.marketEnable==="UPPER"?"售卖中":"已下架"},null,8,["status","text"])])]),e("div",null,[e("div",null,"￥"+p(r(U)(t.price)),1),e("div",ge," 库存："+p(t.cost),1)])])])],2)]),_:2},1032,["onClick"]))),128))]),_:1})])]),_:1},8,["loading"])])])])),[[S]]),e("div",ke,[e("div",{flex:"","flex-j-sb":"","flex-a-c":""},[o[3]||(o[3]=e("div",null,"已选商品",-1)),e("div",{"cursor-pointer":"","text-12px":"","color-gray":"",onClick:O}," 全部清除 ")]),u.max?(c(),E(j,{key:0,"mt-10px":"",type:"normal"},{default:i(()=>[v(" 最多选中"+p(u.max)+"个商品 ",1)]),_:1})):de("",!0),n(j,{"mt-10px":"",type:"normal"},{default:i(()=>o[4]||(o[4]=[v(" 滑动商品可变换展示位置 ")])),_:1}),D((c(),h("div",be,[(c(!0),h(M,null,R(r(a),(t,x)=>(c(),E(ae,{id:t.id,key:x,"move-card":H,index:x},{default:i(()=>[e("div",ye,[e("div",null,[n(l,{src:t.thumbnail||t.small||"https://lili-system.oss-cn-beijing.aliyuncs.com/img.png",width:"75",height:"75"},null,8,["src"])]),e("div",we,[e("div",Ce,[e("div",Ee,p(t.goodsName),1),e("div",null,[n(f,{status:t.marketEnable==="UPPER"?"success":"danger",text:t.marketEnable==="UPPER"?"售卖中":"已下架"},null,8,["status","text"])])]),e("div",null,[e("div",Pe," ￥"+p(r(U)(t.price)),1),e("div",Ne," 库存："+p(t.quantity),1),e("div",Ge,[n(C,{size:"mini",onClick:X=>L(t,x)},{default:i(()=>o[5]||(o[5]=[v(" 删除 ")])),_:2},1032,["onClick"])])])])])]),_:2},1032,["id","index"]))),128))])),[[S]])])])]),_:1},8,["visible"])])}}}),Fe=re(Ue,[["__scopeId","data-v-8dbdd0f9"]]);export{Fe as default};
