import{b as ne,i as se,u as re,c as ue,d as ie,e as de,f as me}from"./goods-CB7YWqUH.js";import{u as pe}from"./useCurrentInstance-BLlvmEjv.js";import{R as fe}from"./validator-B8pIxTAL.js";import{d as ve,r as d,p as ce,h as _e,b as i,o as f,c as b,k as v,e as t,w as a,f as r,u as n,j as L,F as P,i as j,t as C,q as A,M as I,_ as ye}from"./index-C4AMdMz2.js";const ge={style:{width:"100%"}},ke={class:"row"},xe={key:1,class:"paramsGroup"},be={href:"javascript:void(0)"},Ne={key:1,style:{"align-content":"center"}},Ie={style:{"text-align":"center"}},Ve={style:{"text-align":"right"}},Ce={style:{"text-align":"right"}},we=ve({__name:"parameter",setup(Pe){var $;const G=d(),q=d(),V=ce(),w=d([]),m=d({groupName:"",categoryId:"",id:""}),F=d({options:[]}),c=d(!1),p=d(!1),s=d({sort:1,paramName:"",paramType:0,options:"",required:!1,isIndex:!1,groupId:"",categoryId:"",id:null}),y=d(0),g=d(""),z=($=pe().globalProperties)==null?void 0:$.$modal;function k(){ne(V.query.id).then(l=>{l.data.code===200&&(w.value=l.data.result)})}_e(()=>{k()});function O(){m.value={},F.value={},m.value.categoryId=V.query.id,y.value=0,g.value="添加参数组",c.value=!0}function Q(l){m.value={groupName:l.groupName,categoryId:V.query.id,id:l.groupId},y.value=1,g.value="修改参数组",c.value=!0}function R(l,e){z.confirm({title:"确认删除",content:`您确认要删除${e===1?l.groupName:l.paramName}?`,alignCenter:!1,onOk:async()=>{(e===1?await de(l.groupId):await me(l.id)).data.success&&(I.success("删除成功！"),k())}})}function S(l,e){R(e,0)}function H(l){R(l,1)}function U(l){return l===1}function J(l,e){s.value={paramName:e.paramName,options:e.options.split(","),required:U(e.required),isIndex:U(e.isIndex),groupId:e.groupId||"",groupName:l.groupName||"",categoryId:e.categoryId||"",sort:e.sort||1,id:e.id},F.value.options=s.value.options,y.value=1,g.value="修改参数",p.value=!0}async function K(){var e;await((e=G.value)==null?void 0:e.validate())||(y.value===0?(await se(m.value)).data.code===200&&(I.success("参数组修改成功"),k()):(await re(m.value)).data.code===200&&(I.success("参数组修改成功"),k()),c.value=!1)}function W(l){s.value={paramName:"",paramType:1,options:"",required:!1,isIndex:!1,sort:0,groupId:l.groupId,groupName:l.groupName||"",categoryId:V.query.id},g.value="添加参数",y.value=0,p.value=!0}async function X(){var e;if(!await((e=q.value)==null?void 0:e.validate())){const u={...s.value,options:s.value.options?s.value.options.filter(Boolean):[],isIndex:Number(s.value.isIndex),required:Number(s.value.required)};y.value===0?ue(u).then(_=>{_.data.code===200&&(I.success("参数添加成功"),k(),p.value=!1)}):ie(u).then(_=>{_.data.code===200&&(I.success("参数修改成功"),k(),p.value=!1)})}}return(l,e)=>{const u=i("a-button"),_=i("a-card"),Y=i("icon-interaction"),Z=i("icon-down"),D=i("a-doption"),h=i("a-dropdown"),B=i("a-input"),N=i("a-form-item"),E=i("a-form"),T=i("a-modal"),ee=i("a-select"),M=i("a-checkbox"),ae=i("a-input-number");return f(),b(P,null,[v("div",ge,[t(_,null,{default:a(()=>[t(u,{type:"primary",onClick:O},{default:a(()=>e[10]||(e[10]=[r(" 添加 ")])),_:1})]),_:1}),v("div",ke,[n(w).length===0?(f(),L(_,{key:0},{default:a(()=>e[11]||(e[11]=[r(" 暂无参数绑定信息 ")])),_:1})):(f(),b("div",xe,[(f(!0),b(P,null,j(n(w),(o,te)=>(f(),L(_,{key:te,style:{width:"350px",margin:"7px"},bordered:!1},{title:a(()=>[t(Y),r(" "+C(o.groupName),1)]),extra:a(()=>[t(h,{"popup-max-height":!1},{content:a(()=>[t(D,{onClick:x=>Q(o)},{default:a(()=>e[13]||(e[13]=[r(" 编辑 ")])),_:2},1032,["onClick"]),t(D,{onClick:x=>H(o)},{default:a(()=>e[14]||(e[14]=[r(" 删除 ")])),_:2},1032,["onClick"])]),default:a(()=>[v("a",be,[e[12]||(e[12]=r(" 操作 ")),t(Z)])]),_:2},1024)]),default:a(()=>[o.params&&o.params.length>0?(f(!0),b(P,{key:0},j(o.params,(x,oe)=>(f(),b("div",{key:oe,class:"params"},[v("span",null,C(x.paramName),1),v("span",null,[t(u,{type:"text",onClick:le=>J(o,x)},{default:a(()=>e[15]||(e[15]=[r("编辑")])),_:2},1032,["onClick"]),t(u,{type:"text",size:"small",style:{color:"#f56c6c"},onClick:le=>S(o,x)},{default:a(()=>e[16]||(e[16]=[r("删除")])),_:2},1032,["onClick"])])]))),128)):(f(),b("div",Ne," 暂无数据... ")),v("div",Ie,[t(u,{type:"text",onClick:x=>W(o)},{default:a(()=>e[17]||(e[17]=[r(" 添加 ")])),_:2},1032,["onClick"])])]),_:2},1024))),128))]))])]),t(T,{visible:n(c),"onUpdate:visible":e[2]||(e[2]=o=>A(c)?c.value=o:null),width:500},{title:a(()=>[r(C(n(g)),1)]),footer:a(()=>[v("div",Ve,[t(u,{style:{"margin-right":"5px"},onClick:e[1]||(e[1]=o=>c.value=!1)},{default:a(()=>e[18]||(e[18]=[r(" 取消 ")])),_:1}),t(u,{type:"primary",onClick:K},{default:a(()=>e[19]||(e[19]=[r(" 提交 ")])),_:1})])]),default:a(()=>[t(E,{ref_key:"paramGroupFormRules",ref:G,model:n(m)},{default:a(()=>[t(N,{field:"groupName",label:"参数名称",rules:[n(fe)]},{default:a(()=>[t(B,{modelValue:n(m).groupName,"onUpdate:modelValue":e[0]||(e[0]=o=>n(m).groupName=o)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1},8,["visible"]),t(T,{visible:n(p),"onUpdate:visible":e[9]||(e[9]=o=>A(p)?p.value=o:null),width:500},{title:a(()=>[r(C(n(g)),1)]),footer:a(()=>[v("div",Ce,[t(u,{style:{"margin-right":"5px"},onClick:e[8]||(e[8]=o=>p.value=!1)},{default:a(()=>e[22]||(e[22]=[r(" 取消 ")])),_:1}),t(u,{type:"primary",onClick:X},{default:a(()=>e[23]||(e[23]=[r(" 提交 ")])),_:1})])]),default:a(()=>[t(E,{ref_key:"paramFormRules",ref:q,model:n(s)},{default:a(()=>[t(N,{field:"paramName",label:"参数名称"},{default:a(()=>[t(B,{modelValue:n(s).paramName,"onUpdate:modelValue":e[3]||(e[3]=o=>n(s).paramName=o)},null,8,["modelValue"])]),_:1}),t(N,{field:"options",label:"可选值"},{default:a(()=>[t(ee,{modelValue:n(s).options,"onUpdate:modelValue":e[4]||(e[4]=o=>n(s).options=o),style:{width:"320px"},placeholder:"输入后回车添加",multiple:"","allow-create":""},null,8,["modelValue"])]),_:1}),t(N,{field:"specName3",label:"选项"},{default:a(()=>[t(M,{modelValue:n(s).required,"onUpdate:modelValue":e[5]||(e[5]=o=>n(s).required=o),value:"1"},{default:a(()=>e[20]||(e[20]=[r(" 必填 ")])),_:1},8,["modelValue"]),t(M,{modelValue:n(s).isIndex,"onUpdate:modelValue":e[6]||(e[6]=o=>n(s).isIndex=o),value:"1"},{default:a(()=>e[21]||(e[21]=[r(" 可索引 ")])),_:1},8,["modelValue"])]),_:1}),t(N,{field:"sort",label:"排序"},{default:a(()=>[t(ae,{modelValue:n(s).sort,"onUpdate:modelValue":e[7]||(e[7]=o=>n(s).sort=o),class:"input-demo",min:0},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])],64)}}}),Ue=ye(we,[["__scopeId","data-v-d42e5323"]]);export{Ue as default};
