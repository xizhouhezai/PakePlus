import{m as V,n as M,o as B}from"./order-HsmDfkng.js";import{u as q}from"./useCurrentInstance-BLlvmEjv.js";import{S as k,T as F}from"./tools-BfzgO_2s.js";import{U as Y,V as j}from"./dist-PezRi_EG.js";import{d as W,r as u,p,E as K,h as z,b as c,o as m,j as G,w as d,e as s,u as a,f as _,k as n,t as b,c as S,F as H,i as J,s as Q,M as X,_ as Z}from"./index-C4AMdMz2.js";const ee={class:"header"},te={"mr-30px":""},ae={style:{color:"#333"}},se={style:{color:"#333"}},le={key:0},oe={class:"goods",flex:""},re=["src","alt"],ne={class:"goods-info"},ie={class:"line-clamp-2"},de=W({__name:"index",setup(ue){var h;const f=u("ALL"),l=u({orderType:"NORMAL,VIRTUAL",serviceStatus:p().query.serviceStatus?p().query.serviceStatus:f.value==="ALL"?"":f.value,sort:"createTime",order:"desc"}),g=u(!1),i=u({applyAfterSale:0,buyerReturnAfterSale:0,waitRefundAfterSale:0,sellerTermination:0,buyerCancel:0,pass:0,refuse:0}),v=u(),x=u({total:0}),I=(h=q().globalProperties)==null?void 0:h.$modal,R=u(""),T=[{label:"订单编号",model:"orderSn",disabled:!1,input:!0},{label:"售后单号",model:"sn",disabled:!1,input:!0},{label:"售后类型",model:"serviceType",disabled:!1,select:{options:k}},{label:"商家名称",model:"storeName",disabled:!1,input:!0},{label:"会员昵称",model:"memberName",disabled:!1,input:!0},{label:"申请时间",disabled:!1,datePicker:{type:"range"}}],N=[{title:"商品名称",dataIndex:"goodsName",width:300,slot:!0,ellipsis:!1,slotTemplate:"goods"},{title:"会员ID",dataIndex:"memberId",width:120},{title:"会员昵称",dataIndex:"memberName",width:120,member:!0},{title:"商家名称",dataIndex:"storeName",width:120,slot:!0,store:!0},{title:"售后金额",dataIndex:"applyRefundPrice",currency:!0,width:110},{title:"售后类型",dataIndex:"serviceType",slot:!0,width:80,slotData:{badge:k}},{title:"售后状态",dataIndex:"serviceStatus",slot:!0,width:190,slotData:{badge:F}},{title:"申请时间",width:180,dataIndex:"createTime"}],L={title:"操作",width:100,methods:[{title:"查看",callback:"afterOrderDetail",type:"text",status:"success"}]};async function A(){const o=await V(l.value);if(o.data.success){const e=[];o.data.result.records&&o.data.result.records.length&&o.data.result.records.forEach(r=>{e.push({...r,customType:"full"}),e.push(r)}),v.value=e,x.value=o.data.result}}async function E(){if(g.value)return;const o=await M();o.data.success&&(i.value=o.data.result,g.value=!0)}async function C(){I.confirm({title:"确认导出",content:"确定要导出订单数据吗？导出功能为异步导出，需要去 运营 - 导出记录 下载",onOk:async()=>{(await B(l.value)).data.success&&X.success("导出成功,请前往 “运营 - 导出记录” 进行下载")}})}return K(()=>l.value,()=>{A()},{deep:!0,immediate:!0}),z(()=>{p().query.orderSn&&(l.value.orderSn=p().query.orderSn),A(),E()}),(o,e)=>{const r=c("a-tab-pane"),P=c("a-tabs"),D=c("a-button"),$=c("a-row"),w=c("a-typography-text"),O=c("a-card");return m(),G(O,{class:"general-card",title:"售后管理",bordered:!1},{default:d(()=>[s(P,{"default-active-key":a(f),onChange:e[0]||(e[0]=t=>{a(l).serviceStatus=t==="ALL"?"":t})},{default:d(()=>[s(r,{key:"ALL",title:"全部"}),s(r,{key:"APPLY",title:`申请中（${a(i).applyAfterSale}）`},null,8,["title"]),s(r,{key:"BUYER_RETURN",title:`待卖家收货（${a(i).buyerReturnAfterSale}）`},null,8,["title"]),s(r,{key:"WAIT_REFUND",title:`待平台退款（${a(i).waitRefundAfterSale}）`},null,8,["title"]),s(r,{key:"SELLER_TERMINATION",title:`卖家拒绝收货（${a(i).sellerTermination}）`},null,8,["title"]),s(r,{key:"BUYER_CANCEL",title:`买家取消售后（${a(i).buyerCancel}）`},null,8,["title"]),s(r,{key:"PASS",title:`通过售后（${a(i).pass}）`},null,8,["title"]),s(r,{key:"REFUSE",title:`拒绝售后（${a(i).refuse}）`},null,8,["title"])]),_:1},8,["default-active-key"]),s(a(Y),{columns:T,onReset:e[1]||(e[1]=t=>{l.value={...a(l),...t}}),onSearch:e[2]||(e[2]=t=>{l.value={...a(l),...t}})}),s($,{"mb-16px":""},{default:d(()=>[s(D,{type:"primary","ml-5px":"",onClick:C},{default:d(()=>e[5]||(e[5]=[_(" 导出售后 ")])),_:1})]),_:1}),s(a(j),{ref_key:"tablePageRef",ref:R,columns:N,methods:L,"data-list":a(v),total:a(x).total,bordered:!0,"custom-col":!0,colspan:8,onPaginationChange:e[3]||(e[3]=t=>{l.value={...a(l),...t}}),onAfterOrderDetail:e[4]||(e[4]=t=>{o.$openWindow({name:"after-order-detail",query:{id:t.record.sn}})})},{full:d(({data:t})=>[n("div",ee,[n("p",te,[e[6]||(e[6]=_(" 售后服务单号：")),s(w,{copyable:"",bold:""},{default:d(()=>[n("span",ae,b(t.sn),1)]),_:2},1024)]),n("p",null,[e[7]||(e[7]=_(" 订单编号：")),s(w,{copyable:"",bold:""},{default:d(()=>[n("span",se,b(t.orderSn),1)]),_:2},1024)])])]),goods:d(({data:t})=>[t!=null&&t.afterSaleItemArray.length?(m(),S("div",le,[(m(!0),S(H,null,J(t==null?void 0:t.afterSaleItemArray,(y,U)=>(m(),S("div",{key:U},[n("div",oe,[n("img",{src:y.goodsImage,alt:y.goodsName,style:{width:"56px",height:"56px","object-fit":"cover"}},null,8,re),n("div",ne,[n("span",ie,b(y.goodsName),1)])])]))),128))])):Q("",!0)]),_:1},8,["data-list","total"])]),_:1})}}}),_e=Z(de,[["__scopeId","data-v-a58a0491"]]);export{_e as default};
