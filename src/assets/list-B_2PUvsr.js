import{g as at,x as ot,y as lt,a as G,A as st,z as nt}from"./goods-CB7YWqUH.js";import{u as rt}from"./useCurrentInstance-BLlvmEjv.js";import{m as ut,g as Te}from"./tools-BfzgO_2s.js";import{R as de,V as Se}from"./validator-B8pIxTAL.js";import{l as D,m as _,r as i,M as k,d as it,p as dt,a as ct,h as pt,ad as mt,b as v,o as c,c as w,e as r,w as o,u as a,j as b,f as d,s as R,k as u,t as C,q as $,F as Z,i as ee,ae as Ee,_ as ft}from"./index-C4AMdMz2.js";import{U as gt,V as vt}from"./dist-PezRi_EG.js";const At="/assets/bg-empty-Cw6lf58F.png",yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAsAAAASCAYAAACNdSR1AAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAGlSURBVHgBbVI7TgNBDLVnBhQqcgNCicRHW0FEkxT8qsAJICcATgCcAHECxAkIFQIKoIpSsUroWW6wDVGQdmzsSYJ2k7iZGT9/3vMYYcIe2x8Vi+7Wc9Y8qEZJHsPJQGPsKwJWGDjpz/voKIrSMW7ywcaYSxQXEtQlobzway4LeLGNaRD7h53q2hsw3RnERh53z+3uiV7YQGiHPDwZoYxDajULthKw506P89nKFTNzxI7ulfs0DeImZBgJjzgEOP4Ip7zVz0RXIRjVYfF4d3s1npvL6uIbqcfkR97ql5LSAWPjie6kd+2p07vo96EinONR17Q0gPJTp3stwo+B6EY4f34J0wK32YaJ00BR2GKmb4O2kU+UaaReRmjRLInwQxWYsqf3/a2NM0+2rhXGlTJyUfAL/i/QOOEkdlBdSRjofDghutJ3SLN4KpXf8aXdq8mHvCoVouzGuflFGVVLx+nBJ7JUF8Kn5skth0USxYei+HqWUOVNwM29zfVWYeu0CxmWb8Z7ZDpnb9/CnAs/ODJdICIfwIwpzgdOBauVSpDqig5KEE9if6EuxtOCJO4pAAAAAElFTkSuQmCC",bt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAE8SURBVHgBfVFNTgJRDG77Hi5gIUeYAwjCRnEFK+EWcgO5gXgChhtwA+PCKLgwLAy4GgfdwxGGjVFwWl8nTDIxA02atN/Xr+kPPs4Cz6C5gZ0xyFqEfY0RqUeAxym3jWlIFqwHhDUQmKojYtmQDYjMixNEKS4IrQJxzapSRNbti+po12g0mYe+AHqdRqWfdn+ef1yJU5KY3wgBTyFjIhChyHsWYxQvhniFmozfFiMVCfN9MruhZiKMebrbpQkE5cuzSp0UaJ9XuwRyC3tMUIZavI+H8Szsq+dxlAZ63rsgKP8vUCyLU1rsTrks/RQGycyAK3KLa1z8Nn5pY5cPr5+1hFN1cWMCERp2Gid+3hhP87Dn/nP9dRTXbXFDvksiZI4ms0UXcreGyD0OStvCwOrNgTl0cAsOGcOUMV7/ARR9ii9VsJWnAAAAAElFTkSuQmCC",kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA0AAAAMCAYAAAC5tzfZAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAFTSURBVHgBjVJLTgJBEK3qHiJBE8cTyAWQmRWymw0SdswJgBMYboAn0BvAnICdBljIRgluBsG9coNxYcJnqstuBEI0MVNJp15Xv5dXXd0I23gYhVmpUjZY3CYV+z9V6SGyw6zuFmmIfNeNTBX7T2+OJj4Cw+eGh3Cu8XwDEU5NZn1msALulAsXTcGW6pKy3KvLXDZ1FDusVGCwWaDA18SGwaVC7kwgOr3naRX74+k7KWpAgpAoa8w8t3QTtgBRTyICgXmgjYijcjGfSNQbvbZMtnaFwWjmMUKHOK4LkHVE9L70HTNL2dHDsfUAvB13LyoVc0Odstvt8MCg+ttxL7ofT6sW4/WasCmEciRiTTv5x0t5qzuIzKj/iFClJgjxzSqz/kgv0hEQTcxj6rYDIIwOnXDwMgtjipuVojuEf6IbhvbJymor4mD7I6ALCYKAgkoh3/oGbRiPFvyqTbUAAAAASUVORK5CYII=";function Ct(s){return D({url:"/system/pick/farm/getFarmByKeyWords",method:_.GET,needToken:!0,params:s})}function It(s){return D({url:"/system/pick/farm/getCropSubject",method:_.GET,needToken:!0,params:s})}function ht(s){return D({url:"/system/pick/listCropFromPlantByCropSubjectIdentifierAndFarmId",method:_.POST,needToken:!0,params:s})}function wt(s){return D({url:"/system/pick/listLandByFarmId",method:_.GET,needToken:!0,params:s})}function xt(s){return D({url:"/system/pick/qrcode/listByFarmId",method:_.POST,needToken:!0,params:s})}function Tt(s){return D({url:"/system/good/pick/ref/addRef",method:_.POST,needToken:!0,params:s})}function St(s){return D({url:"/system/good/pick/ref/delByGoodId",method:_.GET,needToken:!0,params:s})}const Et={agri:"农业",animal:"畜牧业",fishery:"渔业",forestry:"林业"},P={agri:["采收","采收重量"],animal:["出栏","出栏数量"],fishery:["捕捞","捕捞重量"],forestry:["采收","采收数量"]},W=i(!1),z=i(!1),ae=i(!1);i([]);const l=i({farmId:"",pickerTime:[],cropCategory:"",cropId:"",landId:""}),Ue=i(null),Ut=i(null),ce=i(!1),K=i([]),N=i({current:1,pageSize:10,total:0}),L=i(!1),V=i({}),J=i({}),Q=i([]),F=i([]),X=i([]),j=i([]),pe=i([{title:"农产品",slotName:"cropName"},{title:"采收重量",slotName:"pickOutput"},{title:"采收时间",slotName:"pickTime"},{title:"地块",dataIndex:"landName"},{title:"操作人",dataIndex:"pickUserName"},{title:"操作",slotName:"optional"}]);async function Rt(s){W.value=!0,J.value=s,Ue.value.resetFields(),oe("all")}async function Vt(s){ae.value=!0,J.value=s}async function Nt(s){z.value=!0,console.warn(s,"currentTraceInfo"),V.value=s}async function Bt(s){return L.value=!0,await Yt(),L.value=!1,W.value=!1,oe("all"),s.init(),!0}async function Mt(s){return console.warn(s,"goodTableRef"),L.value=!0,await Gt(),L.value=!1,s.init(),!0}async function Ft(s){s?await Lt(s):K.value=[]}async function Dt(){oe(),l.value.farmId?(await jt(l.value.farmId),l.value.cropCategory&&await Ve(l.value.farmId,l.value.cropCategory),await Ot(l.value.farmId)):l.value.farmId="",j.value=[],N.value.current=1,await le()}function oe(s="farm"){switch(s){case"all":j.value=[],N.value.current=1,K.value=[],l.value.farmId="",F.value=[],l.value.cropId="",l.value.cropCategory="",Q.value=[],X.value=[],l.value.landId="",l.value.pickTime=[];break;case"farm":F.value=[],l.value.cropId="",l.value.cropCategory="",Q.value=[],X.value=[],l.value.landId="",l.value.pickTime=[];break;case"subject":l.value.cropId="",F.value=[];break}}async function _t(){oe("subject"),l.value.cropCategory&&(F.value=[],l.value.cropId="",await Ve(l.value.farmId,l.value.cropCategory)),j.value=[],N.value.current=1,Re(),await le()}function Re(){pe.value[1].title=`${P[l.value.cropCategory]?P[l.value.cropCategory][1]:"采收重量"}`,pe.value[2].title=`${P[l.value.cropCategory]?P[l.value.cropCategory][0]:"采收"}时间`}async function te(){l.value.farmId&&(j.value=[],N.value.current=1,await le())}async function Pt(s){N.value.current=s,await le()}async function Lt(s){ce.value=!0;try{const p=await Ct({keyWords:s});p.status===200&&(K.value=p.data.result,console.warn(K.value,"农场列表"))}catch(p){console.error(p)}finally{ce.value=!1}}async function jt(s){try{const p=await It({farmId:s});p.status===200&&p.data.result.length?(Q.value=p.data.result.map((f,x)=>({id:x+1,name:Et[f]||"",value:f})),l.value.cropCategory=p.data.result[0]):(Q.value=[],l.value.cropCategory=""),Re()}catch(p){console.error(p)}}async function Ve(s,p){var f,x;try{const I=await ht({farmId:s,cropSubjectIdentifier:p});I.status===200&&((x=(f=I.data.result)==null?void 0:f.list)!=null&&x.length)?F.value=I.data.result.list.filter(T=>T):(F.value=[],l.value.cropId="")}catch(I){console.error(I)}}async function Ot(s){var p;try{const f=await wt({farmId:s});f.status===200&&((p=f.data.result)!=null&&p.length)?X.value=f.data.result:(X.value=[],l.value.landId="")}catch(f){console.error(f)}}async function le(){var s;try{const p=Object.entries({farmId:l.value.farmId||"",subjectIdentifier:l.value.cropCategory||"",cropId:l.value.cropId||"",landId:l.value.landId||"",startTime:l.value.pickerTime&&l.value.pickerTime[0]?`${l.value.pickerTime[0]} 00:00:00`:"",endTime:l.value.pickerTime&&l.value.pickerTime[1]?`${l.value.pickerTime[1]} 23:59:59`:""}).reduce((x,[I,T])=>(T!=null&&T!==""&&(x[I]=T),x),{}),f=await xt({pageNo:N.value.current,pageSize:N.value.pageSize,...p});f.status===200&&((s=f.data.result)!=null&&s.list.length)&&(j.value=f.data.result.list,N.value.total=f.data.result.totalCount)}catch(p){console.error(p)}}async function Yt(){try{(await Tt({goodId:J.value.id,snkdPickId:V.value.pickId,snkdPickNo:V.value.pickNo,snkdCropId:V.value.cropId})).status===200&&k.success("关联成功")}catch(s){console.error(s)}}async function Gt(){try{(await St({goodId:J.value.id})).status===200&&k.success("取消关联成功")}catch(s){console.error(s)}}const zt={key:0},Wt={key:1},Kt={key:0},Qt={key:1},Xt={key:2},Jt=["title"],qt={style:{height:"calc(100% - 44px)"}},Ht={class:"h-510px flex flex-col justify-center flex-a-c p-100px"},$t={class:"text-16px color-#333"},Zt={class:"flex flex-a-c"},ea=["src"],ta={style:{"margin-left":"10px"}},aa={class:"flex flex-col justify-start p-l-50px align-start text-14px color-#525e71"},oa={class:"mt-20px flex justify-start flex-a-c"},la=["title"],sa={class:"mt-20px flex justify-start flex-a-c"},na=["title"],ra={class:"mt-20px flex justify-start flex-a-c"},ua={class:"ellipsis inline-block max-w-245px"},ia=it({__name:"list",props:{templateModel:{type:String,default:"normal"},scene:{type:String,default:""}},emits:["selectTableChange"],setup(s,{emit:p}){var be;const f=s,x=p,I=dt(),T=i("UPPER"),y=i({authFlag:"PASS",goodsStatus:T.value,scene:f.scene}),me=i([]),fe=i(0),ge=i(0),se=(be=rt().globalProperties)==null?void 0:be.$modal,S=i(),ve=i(),O=i(!1),h=i([]),ne=i(""),B=f.templateModel==="normal",Ne=[{label:"通过",value:"PASS"},{label:"拒绝",value:"REFUSE"}],M=i({authMessage:"",goodsAuth:"PASS"}),Be=[{label:"商品名称",model:"goodsName",disabled:!1,input:!0},{label:"商品编号",model:"id",disabled:!1,input:!0},{label:"店铺名称",model:"storeName",disabled:!1,input:!0},{label:"状态",model:"marketEnable",disabled:!1,select:{options:ut}},{label:"商品类型",model:"goodsType",disabled:!1,select:{options:Te}},{label:"类目名称",model:"categoryPath",disabled:!1,category:!0}],Me=[{title:"商品名称",dataIndex:"goodsName",slot:!0,ellipsis:!1,width:B?300:250,slotData:{goods:{goodsName:"goodsName",goodsImage:"original",goodsId:"goodsId",skuId:"skuId",linkTo:!0}}},{title:"商品编号",dataIndex:"id",width:200},{title:"商品价格",dataIndex:"price",currency:!0},{title:"商品类型",dataIndex:"goodsType",slot:!0,slotData:{badge:Te}},{title:"上架状态",dataIndex:"marketEnable",slot:!0,slotTemplate:"marketEnable"},{title:"审核状态",dataIndex:"authFlag",slot:!0,slotTemplate:"authFlag"},{title:"店铺名称",dataIndex:"storeName",width:200,slot:!0,store:!0}],Fe=B?{title:"操作",width:200,fixed:"right",methods:[{slot:!0,slotTemplate:"btnList"}]}:{},g=ct({enableAddModal:!1,formLoading:!1,fid:"",form:{reason:"店铺关闭"}});function De(n){x("selectTableChange",{...n[0],___type:"goods"}),h.value=n}async function _e(){const n=await lt();n.data.success&&(me.value=n.data.result)}function Pe(n){g.form.categoryPath=n}function Le(n){y.value={...y.value,...n,categoryPath:g.form.categoryPath}}function je(n){n&&(Object.keys(n.record).forEach(e=>{g.form.hasOwnProperty(e)&&(g.form[e]=n.record[e])}),g.form.reason=n.record.reason,g.fid=n.record.id,g.enableAddModal=!0)}function Oe(n){g.fid=n.id,g.enableAddModal=!0}async function Ye(){var e;if(!await((e=ve.value)==null?void 0:e.validate())){const m={goodsIds:[g.fid],goodsStatus:"DOWN",underReason:g.form.reason};G(m).then(re=>{re.data.success&&(k.success("操作成功"),g.enableAddModal=!1,S.value.init())})}}function Ge(n){se.confirm({title:"确认上架",content:`您确认要上架${n.goodsName}?`,alignCenter:!1,onOk:async()=>{const e={goodsIds:[n.id],goodsStatus:"UPPER"};(await G(e)).data.success&&(k.success("上架成功"),S.value.init())}})}function ze(n){n.statusCount&&(fe.value=n.statusCount.statusUnaudited,ge.value=n.statusCount.statusRefuse)}function We(){if(h.value.length<=0){k.error("您还未选择要删除的商品");return}h.value.forEach(e=>{ne.value+=`${e.id},`});const n=ne.value.substring(0,ne.value.length-1);se.confirm({title:"确认删除",content:`您确定要删除所选的${h.value.length}个商品`,alignCenter:!1,onOk:async()=>{(await st({goodsId:n})).data.success&&(k.success("删除成功"),S.value.init())}})}function Ke(){se.confirm({title:"确认导出",content:"确定要导出商品数据吗？导出功能为异步导出，需要去 运营 - 导出记录 下载",onOk:async()=>{(await nt(y.value)).data.success&&k.success("导出成功,请前往 “运营 - 导出记录” 进行下载")}})}function Ae(n){if(h.value.length<=0&&!n){k.error("您还未选择要审核的商品");return}n&&(h.value=[{id:n}]),O.value=!0}function Qe(){if(h.value.length<=0){k.error("您还未选择要上架的商品");return}const n=[];h.value.forEach(m=>{n.push(m.id)}),G({goodsIds:n,goodsStatus:"UPPER"}).then(m=>{m.data.success&&(k.success("上架成功"),S.value.init())})}function Xe(){if(h.value.length<=0){k.error("您还未选择要下架的商品");return}const n=[];h.value.forEach(m=>{n.push(m.id)}),G({goodsIds:n,goodsStatus:"DOWN"}).then(m=>{m.data.success&&(k.success("下架成功"),S.value.init())})}function Je(){const n=[];h.value.forEach(m=>{n.push(m.id)});const e={goodsIds:n,goodsAuth:M.value.goodsAuth,authMessage:M.value.authMessage};G(e).then(m=>{m.data.success&&(k.success("审核成功"),S.value.init())}),O.value=!1}function ye(n){y.value.goodsStatus=n,T.value=n,n==="UPPER"?y.value.authFlag="PASS":y.value.authFlag=""}return pt(()=>{I.query&&I.query.status&&ye(I.query.status),_e()}),mt(()=>{}),(n,e)=>{const m=v("a-tab-pane"),re=v("a-tabs"),A=v("a-button"),qe=v("a-row"),ke=v("a-popover"),He=v("a-space"),Ce=v("a-input"),E=v("a-form-item"),ue=v("a-form"),Y=v("a-modal"),$e=v("a-radio-group"),ie=v("a-empty"),q=v("a-option"),H=v("a-select"),Ze=v("a-range-picker"),et=v("a-table"),tt=v("a-card");return c(),w("div",null,[r(tt,{class:"general-card",title:"商品列表",bordered:!1},{default:o(()=>{var Ie;return[r(re,{"active-key":a(T),onChange:ye},{default:o(()=>[r(m,{key:"ALL",title:"全部"}),r(m,{key:"UPPER",title:"出售中的商品"}),r(m,{key:"DOWN",title:"仓库中的商品"}),r(m,{key:"TOBEAUDITED",title:`待审核商品（${a(fe)}）`},null,8,["title"]),r(m,{key:"REFUSE",title:`审核未通过的商品（${a(ge)}）`},null,8,["title"])]),_:1},8,["active-key"]),r(a(gt),{"category-data":a(me),"row-span":B?0:12,columns:Be,onCategoryList:Pe,onReset:e[0]||(e[0]=t=>{y.value={...a(y),...t}}),onSearch:e[1]||(e[1]=t=>{Le(t)})},null,8,["category-data","row-span"]),B?(c(),b(qe,{key:0,style:{"margin-bottom":"16px"}},{default:o(()=>[r(A,{type:"primary",onClick:We},{default:o(()=>e[17]||(e[17]=[d(" 批量删除 ")])),_:1}),r(A,{type:"primary","ml-5px":"",onClick:Qe},{default:o(()=>e[18]||(e[18]=[d(" 批量上架 ")])),_:1}),r(A,{type:"primary","ml-5px":"",onClick:Xe},{default:o(()=>e[19]||(e[19]=[d(" 批量下架 ")])),_:1}),r(A,{type:"primary","ml-5px":"",onClick:Ke},{default:o(()=>e[20]||(e[20]=[d(" 导出商品 ")])),_:1}),a(y).goodsStatus==="TOBEAUDITED"?(c(),b(A,{key:0,type:"primary","ml-5px":"",onClick:e[2]||(e[2]=t=>Ae())},{default:o(()=>e[21]||(e[21]=[d(" 批量审核 ")])),_:1})):R("",!0)]),_:1})):R("",!0),r(a(vt),{ref_key:"tablePageRef",ref:S,"api-params":a(y),checkbox:!0,radio:!B,"page-size":B?10:6,columns:Me,methods:a(Fe),bordered:!0,api:B?a(at):a(ot),onSelectTableChange:De,onUpdate:je,onParentComponentData:ze},{marketEnable:o(({data:t})=>[t.marketEnable==="UPPER"?(c(),w("div",zt,e[22]||(e[22]=[u("span",{class:"arco-badge-status-dot arco-badge-color-green","mr-8px":""},null,-1),d("上架 ")]))):R("",!0),t.marketEnable==="DOWN"?(c(),w("div",Wt,[e[24]||(e[24]=u("span",{class:"arco-badge-status-dot arco-badge-color-red","mr-8px":""},null,-1)),e[25]||(e[25]=d("下架 ")),r(ke,{title:""},{content:o(()=>[d(C(t.underMessage),1)]),default:o(()=>[e[23]||(e[23]=u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24","ml-4px":""},[u("path",{fill:"none",stroke:"#bbbbbb","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.146 9.074a2.998 2.998 0 0 1 5.28-.838A3 3 0 0 1 12 13v1m0 7a9 9 0 1 1 0-18a9 9 0 0 1 0 18m.05-4v.1h-.1V17z"})],-1))]),_:2},1024)])):R("",!0)]),authFlag:o(({data:t})=>[t.authFlag==="PASS"?(c(),w("div",Kt,e[26]||(e[26]=[u("span",{class:"arco-badge-status-dot arco-badge-color-green","mr-8px":""},null,-1),d("审核通过 ")]))):t.authFlag==="TOBEAUDITED"?(c(),w("div",Qt,e[27]||(e[27]=[u("span",{class:"arco-badge-status-dot arco-badge-color-blue","mr-8px":"",style:{"background-color":"blue"}},null,-1),d("待审核 ")]))):(c(),w("div",Xt,[e[29]||(e[29]=u("span",{class:"arco-badge-status-dot arco-badge-color-red","mr-8px":""},null,-1)),e[30]||(e[30]=d("审核失败 ")),r(ke,{title:""},{content:o(()=>[d(C(t.authMessage),1)]),default:o(()=>[e[28]||(e[28]=u("svg",{xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 24 24","ml-4px":""},[u("path",{fill:"none",stroke:"#bbbbbb","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9.146 9.074a2.998 2.998 0 0 1 5.28-.838A3 3 0 0 1 12 13v1m0 7a9 9 0 1 1 0-18a9 9 0 0 1 0 18m.05-4v.1h-.1V17z"})],-1))]),_:2},1024)]))]),btnList:o(({data:t})=>[r(He,null,{default:o(()=>[t.authFlag==="PASS"&&t.relatedFlag===2?(c(),b(A,{key:0,type:"text",width:"auto",onClick:U=>a(Rt)(t)},{default:o(()=>e[31]||(e[31]=[d(" 关联溯源 ")])),_:2},1032,["onClick"])):R("",!0),t.authFlag==="PASS"&&t.relatedFlag===1?(c(),b(A,{key:1,type:"text",status:"warning",width:"auto",onClick:U=>a(Vt)(t)},{default:o(()=>e[32]||(e[32]=[d(" 取消关联 ")])),_:2},1032,["onClick"])):R("",!0),a(y).goodsStatus==="TOBEAUDITED"?(c(),b(A,{key:2,type:"text",status:"danger",onClick:U=>Ae(t.id)},{default:o(()=>e[33]||(e[33]=[d(" 审核 ")])),_:2},1032,["onClick"])):R("",!0),(t==null?void 0:t.marketEnable)==="DOWN"&&a(y).goodsStatus!=="TOBEAUDITED"?(c(),b(A,{key:3,type:"text",status:"success",onClick:U=>Ge(t)},{default:o(()=>e[34]||(e[34]=[d(" 上架 ")])),_:2},1032,["onClick"])):(t==null?void 0:t.marketEnable)==="UPPER"&&a(y).goodsStatus!=="TOBEAUDITED"?(c(),b(A,{key:4,type:"text",status:"danger",onClick:U=>Oe(t)},{default:o(()=>e[35]||(e[35]=[d(" 下架 ")])),_:2},1032,["onClick"])):R("",!0),r(A,{type:"text",status:"success",onClick:U=>n.$openWindow({name:"goodsdetail",query:{id:t.id}})},{default:o(()=>e[36]||(e[36]=[d(" 查看 ")])),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["api-params","radio","page-size","methods","api"]),r(Y,{visible:a(g).enableAddModal,"onUpdate:visible":e[4]||(e[4]=t=>a(g).enableAddModal=t),"align-center":!1,footer:!1},{title:o(()=>e[37]||(e[37]=[d(" 下架操作 ")])),default:o(()=>[r(ue,{ref_key:"formRef",ref:ve,model:a(g).form,onSubmit:Ye},{default:o(()=>[r(E,{field:"reason",label:"下架原因",rules:[a(de),a(Se)],"validate-trigger":["change"]},{default:o(()=>[r(Ce,{modelValue:a(g).form.reason,"onUpdate:modelValue":e[3]||(e[3]=t=>a(g).form.reason=t)},null,8,["modelValue"])]),_:1},8,["rules"]),r(E,{label:"操作"},{default:o(()=>[r(A,{loading:a(g).formLoading,"html-type":"submit",type:"primary"},{default:o(()=>e[38]||(e[38]=[d(" 保存 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),r(Y,{visible:a(O),"onUpdate:visible":e[8]||(e[8]=t=>$(O)?O.value=t:null),draggable:""},{title:o(()=>e[39]||(e[39]=[d(" 商品审核 ")])),footer:o(()=>[r(A,{key:"submit",type:"primary",onClick:e[7]||(e[7]=t=>Je())},{default:o(()=>e[40]||(e[40]=[d(" 保存 ")])),_:1})]),default:o(()=>[r(ue,{model:a(M)},{default:o(()=>[r(E,{field:"goodsAuth",label:"审核",rules:[a(de)],"validate-trigger":["change"]},{default:o(()=>[r($e,{modelValue:a(M).goodsAuth,"onUpdate:modelValue":e[5]||(e[5]=t=>a(M).goodsAuth=t),options:Ne},null,8,["modelValue"])]),_:1},8,["rules"]),r(E,{field:"authMessage",label:"审核信息",rules:[a(de),a(Se)],"validate-trigger":["change"]},{default:o(()=>[r(Ce,{modelValue:a(M).authMessage,"onUpdate:modelValue":e[6]||(e[6]=t=>a(M).authMessage=t)},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model"])]),_:1},8,["visible"]),(c(),b(Y,{key:(Ie=a(J))==null?void 0:Ie.id,visible:a(W),"onUpdate:visible":e[14]||(e[14]=t=>$(W)?W.value=t:null),width:"1000px","body-style":"height: 690px",footer:!1},{title:o(()=>e[41]||(e[41]=[d(" 商品与农产品溯源关联 ")])),default:o(()=>[r(ue,{ref_key:"traceAuthFormRef",ref:Ue,model:a(l),layout:"inline"},{default:o(()=>[r(E,{field:"farmId","hide-label":""},{default:o(()=>[r(H,{modelValue:a(l).farmId,"onUpdate:modelValue":e[9]||(e[9]=t=>a(l).farmId=t),style:{width:"168px"},size:"large","allow-search":"",loading:a(ce),"allow-clear":"",placeholder:"输入农场名称搜索",onSearch:a(Ft),onChange:a(Dt)},{empty:o(()=>[r(ie,{description:"暂无搜索结果"})]),default:o(()=>[(c(!0),w(Z,null,ee(a(K),t=>(c(),b(q,{key:t.farmId,value:t.farmId},{default:o(()=>[u("span",{title:`${t.farmName}-${t.farmId}`},C(`${t.farmName}-${t.farmId}`),9,Jt)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue","loading","onSearch","onChange"])]),_:1}),r(E,{field:"cropCategory","hide-label":""},{default:o(()=>[r(H,{modelValue:a(l).cropCategory,"onUpdate:modelValue":e[10]||(e[10]=t=>a(l).cropCategory=t),style:{width:"151px"},size:"large",placeholder:"请选择作物大类",onChange:a(_t)},{default:o(()=>[(c(!0),w(Z,null,ee(a(Q),t=>(c(),b(q,{key:t.value,value:t.value,label:t.name},null,8,["value","label"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),r(E,{field:"cropId","hide-label":""},{default:o(()=>[r(H,{modelValue:a(l).cropId,"onUpdate:modelValue":e[11]||(e[11]=t=>a(l).cropId=t),style:{width:"151px"},size:"large","allow-search":"",placeholder:"请选择种养品种","allow-clear":"",onChange:a(te)},{empty:o(()=>[r(ie,{description:"暂无搜索结果"})]),default:o(()=>[(c(!0),w(Z,null,ee(a(F),t=>(c(),b(q,{key:t.id,value:t.id,label:t.cropName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),r(E,{field:"landId","hide-label":""},{default:o(()=>[r(H,{modelValue:a(l).landId,"onUpdate:modelValue":e[12]||(e[12]=t=>a(l).landId=t),style:{width:"151px"},size:"large","allow-search":"",placeholder:"请选择地块","allow-clear":"",onChange:a(te)},{empty:o(()=>[r(ie,{description:"暂无搜索结果"})]),default:o(()=>[(c(!0),w(Z,null,ee(a(X),t=>(c(),b(q,{key:t.landId,value:t.landId,label:t.landName},null,8,["value","label"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),r(E,{field:"pickerTime","hide-label":""},{default:o(()=>[r(Ze,{modelValue:a(l).pickerTime,"onUpdate:modelValue":e[13]||(e[13]=t=>a(l).pickerTime=t),style:{width:"210px"},size:"large",onChange:a(te),onClear:a(te)},null,8,["modelValue","onChange","onClear"])]),_:1})]),_:1},8,["model"]),u("div",qt,[r(et,{ref_key:"traceTableRef",ref:Ut,columns:a(pe),data:a(j),pagination:a(N),scroll:{x:"100%",y:"100%"},scrollbar:!0,onPageChange:a(Pt)},{empty:o(()=>[u("div",Ht,[e[42]||(e[42]=u("img",{src:At,alt:"picture",style:{width:"151px",height:"115px","margin-bottom":"24px"}},null,-1)),u("span",$t,C(a(l).farmId?"暂无溯源":"暂无溯源，请先选择农场"),1)])]),cropName:o(({record:t})=>[u("div",Zt,[u("img",{src:t.goodsImgUrl,alt:"picture",style:{width:"28px",height:"28px","border-radius":"50%"}},null,8,ea),u("span",ta,C(t.goodsName),1)])]),pickOutput:o(({record:t})=>[u("span",null,C(t.pickOutput)+" "+C(a(l).cropCategory==="agri"||a(l).cropCategory==="fishery"?"公斤":t.cropCategoryUnit||"公斤"),1)]),pickTime:o(({record:t})=>[u("span",null,C(a(Ee)(t.pickTime,"YYYY-MM-DD HH:mm")),1)]),optional:o(({record:t})=>[r(A,{type:"primary",onClick:U=>a(Nt)(t)},{default:o(()=>e[43]||(e[43]=[d(" 关联 ")])),_:2},1032,["onClick"])]),_:1},8,["columns","data","pagination","onPageChange"])])]),_:1},8,["visible"])),a(z)?(c(),b(Y,{key:1,visible:a(z),"onUpdate:visible":e[15]||(e[15]=t=>$(z)?z.value=t:null),width:"425px","on-before-ok":()=>a(Bt)(a(S)),"ok-loading":a(L),"unmount-on-close":""},{title:o(()=>e[44]||(e[44]=[d(" 确定要关联该农产品溯源？ ")])),default:o(()=>{var t,U,he,we,xe;return[u("div",aa,[u("div",oa,[e[45]||(e[45]=u("img",{src:yt,alt:"picture","mr-5px":"","h-18px":""},null,-1)),e[46]||(e[46]=u("span",null,"农产品：",-1)),u("span",{title:(t=a(V))==null?void 0:t.goodsName,class:"ellipsis inline-block max-w-245px"},C((U=a(V))==null?void 0:U.goodsName),9,la)]),u("div",sa,[e[47]||(e[47]=u("img",{src:bt,alt:"picture","mr-5px":"","h-12px":""},null,-1)),e[48]||(e[48]=u("span",null,"地块名称：",-1)),u("span",{title:(he=a(V))==null?void 0:he.landName,class:"ellipsis inline-block max-w-245px"},C((we=a(V))==null?void 0:we.landName),9,na)]),u("div",ra,[e[49]||(e[49]=u("img",{src:kt,alt:"picture","mr-5px":"","h-12px":""},null,-1)),u("span",null,C(a(P)[a(l).cropCategory]?a(P)[a(l).cropCategory][0]:"采收")+"时间：",1),u("span",ua,C(a(Ee)((xe=a(V))==null?void 0:xe.pickTime,"YYYY-MM-DD HH:mm")),1)])])]}),_:1},8,["visible","on-before-ok","ok-loading"])):R("",!0),r(Y,{visible:a(ae),"onUpdate:visible":e[16]||(e[16]=t=>$(ae)?ae.value=t:null),width:"425px","on-before-ok":()=>a(Mt)(a(S)),"ok-loading":a(L),"unmount-on-close":""},{title:o(()=>e[50]||(e[50]=[d(" 提示 ")])),default:o(()=>[e[51]||(e[51]=u("div",{class:"color-#525e71"}," 确定要取消关联该农产品溯源？ ",-1))]),_:1},8,["visible","on-before-ok","ok-loading"])]}),_:1})])}}}),va=ft(ia,[["__scopeId","data-v-9bdbcdbf"]]);export{va as default};
