import{G as O,H as V,I as L}from"./promotion-ChRoyrm_.js";import{u as A}from"./useCurrentInstance-BLlvmEjv.js";import{u as B}from"./filters-D05Q2eUM.js";import{G as M}from"./tools-BfzgO_2s.js";import{U,V as W}from"./dist-PezRi_EG.js";import{d as j,n as q,r as f,E as H,b as r,o as p,j as m,w as s,e as n,u as l,f as d,t as g,k as K,s as _,M as v}from"./index-C4AMdMz2.js";const tt=j({__name:"list",setup(z){var x;const y=q(),c=f(),S=f("START"),o=f({sort:"createTime",promotionStatus:S.value}),k=(x=A().globalProperties)==null?void 0:x.$modal,N=[{label:"商品名称",model:"goodsName",disabled:!1,input:!0},{label:"积分区间",model:"points",disabled:!1,input:!0},{label:"SKU编码",model:"skuId",disabled:!1,input:!0}],I=[{title:"商品名称",dataIndex:"goodsName",slot:!0,width:250,slotData:{goods:{goodsImage:"thumbnail",goodsName:"goodsName"}}},{title:"市场价",dataIndex:"originalPrice",currency:!0,width:100},{title:"结算价",dataIndex:"settlementPrice",currency:!0,width:100},{title:"库存数量",dataIndex:"activeStock",width:100},{title:"活动剩余库存",dataIndex:"activeStock",width:150},{title:"兑换积分",dataIndex:"points",width:100},{title:"所属店铺",dataIndex:"storeName",width:100,slot:!0,store:!0},{title:"活动时间",width:350,ellipsis:!1,dataIndex:"startTime",slot:!0,slotTemplate:"time"},{title:"状态",dataIndex:"promotionStatus",width:100,slot:!0,slotData:{badge:M}},{title:"分类",dataIndex:"pointsGoodsCategoryName"}],T={title:"操作",width:260,methods:[{title:"操作",callback:"actipn",slot:!0,slotTemplate:"action"}]};function b(a){k.confirm({title:"确认删除",content:"您确认要删除此积分商品?",alignCenter:!1,onOk:async()=>{(await V(a)).data.success&&(v.success("删除成功"),c.value.init())}})}function h(){y.push({name:"add-points-goods"})}function E(a){y.push({name:"edit-points-goods",query:{id:a.id}})}function P(a,e){let i="";i="关闭",k.confirm({title:`确认${i}`,content:`您确认要${i}此积分商品?`,alignCenter:!1,onOk:async()=>{(await L(a)).data.success&&(v.success(`${i}成功`),c.value.init())}})}return H(()=>o.value.points,a=>{a&&a.split("_").length===2?(o.value.pointsS=a.split("_")[0],o.value.pointsE=a.split("_")[0]):(o.value.points="",delete o.value.pointsS,delete o.value.pointsE)},{deep:!0}),(a,e)=>{const i=r("a-tab-pane"),C=r("a-tabs"),u=r("a-button"),D=r("a-space"),R=r("a-col"),$=r("a-row"),G=r("a-card");return p(),m(G,{class:"general-card",title:"积分商品",bordered:!1},{default:s(()=>[n(C,{"default-active-key":l(S),onChange:e[0]||(e[0]=t=>{l(o).promotionStatus=t})},{default:s(()=>[n(i,{key:"NEW",title:"未开始"}),n(i,{key:"START",title:"已开始"}),n(i,{key:"END",title:"已结束"}),n(i,{key:"CLOSE",title:"已关闭"})]),_:1},8,["default-active-key"]),n(l(U),{columns:N,onReset:e[1]||(e[1]=t=>{o.value={...l(o),...t}}),onSearch:e[2]||(e[2]=t=>{o.value={...l(o),...t}})}),n($,{style:{"margin-bottom":"16px"}},{default:s(()=>[n(R,{span:16},{default:s(()=>[n(D,null,{default:s(()=>[n(u,{type:"primary",onClick:h},{default:s(()=>e[3]||(e[3]=[d(" 添加积分商品 ")])),_:1})]),_:1})]),_:1})]),_:1}),n(l(W),{ref_key:"tablePageRef",ref:c,columns:I,methods:T,api:l(O),"api-params":l(o),bordered:!0,onDelete:b},{price:s(({data:t})=>[d(g(t.price?l(B)(t.price,"¥"):`${t.couponDiscount||0}折`),1)]),time:s(({data:t})=>[d(g(t.startTime),1),e[4]||(e[4]=K("span",{style:{margin:"0 10px"}},"-",-1)),d(g(t.endTime),1)]),action:s(({data:t})=>[t.promotionStatus==="CLOSE"||t.promotionStatus==="NEW"?(p(),m(u,{key:0,type:"text",status:"warning",style:{"margin-right":"10px"},onClick:w=>E(t)},{default:s(()=>e[5]||(e[5]=[d(" 编辑 ")])),_:2},1032,["onClick"])):_("",!0),t.promotionStatus==="START"||t.promotionStatus==="NEW"?(p(),m(u,{key:1,type:"text",status:"danger",style:{"margin-right":"10px"},onClick:w=>P(t.id,"CLOSE")},{default:s(()=>e[6]||(e[6]=[d(" 关闭 ")])),_:2},1032,["onClick"])):_("",!0),t.promotionStatus==="CLOSE"||t.promotionStatus==="END"?(p(),m(u,{key:2,type:"text",status:"danger",style:{"margin-right":"10px"},onClick:w=>b(t.id)},{default:s(()=>e[7]||(e[7]=[d(" 删除 ")])),_:2},1032,["onClick"])):_("",!0)]),_:1},8,["api","api-params"])]),_:1})}}});export{tt as default};
