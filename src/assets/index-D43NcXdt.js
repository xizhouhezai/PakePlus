import{u as N,b as se}from"./shops-fXVW_gE8.js";import{u as oe}from"./useCurrentInstance-BLlvmEjv.js";import{z as I,A as D,B as ne}from"./tools-BfzgO_2s.js";import{U as le,V as ie}from"./dist-PezRi_EG.js";import{d as re,r as p,n as de,h as ue,E as ce,b as r,o as g,j as b,w as o,u as l,e as s,s as P,f as c,k as O,c as $,t as pe,M as R,_ as fe}from"./index-C4AMdMz2.js";const me={"w-full":""},_e={key:0},ge={key:1},ye={class:"paginationBox"},be=re({__name:"index",props:{templateModel:{type:String,default:"normal"}},emits:["selectTableChange","callback"],setup(T,{expose:U,emit:M}){var E;const V=T,w=M,h=(E=oe().globalProperties)==null?void 0:E.$modal,k=V.templateModel==="normal",v=p(!0),y=p({total:0}),f=p([]),m=p([]),x=de(),S=p(),z=p("OPEN"),i=p({scene:"SUPPLIER",sort:"createTime",storeStatus:"OPEN"}),B=[{label:"店铺名称",model:"storeName",disabled:!1,input:!0},{label:"店铺状态",model:"storeStatus",disabled:!1,select:{options:I}},{label:"认证状态",model:"verify",disabled:!1,select:{options:D}},{label:"创建时间",disabled:!1,datePicker:{type:"range"}}],q=[{title:"店铺名称",dataIndex:"storeName",width:200},{title:"店铺LOGO",dataIndex:"storeLogo",width:100,slot:!0,slotTemplate:"storeLogo"},{title:"店铺简介",dataIndex:"storeDesc",width:260},{title:"是否自营",dataIndex:"selfOperated",slot:!0,width:100,slotData:{badge:ne}},{title:"是否认证",dataIndex:"verify",slot:!0,width:100,slotData:{badge:D}},{title:"店铺状态",dataIndex:"storeStatus",width:100,slot:!0,slotData:{badge:I}},{title:"创建时间",width:180,dataIndex:"createTime"}],L={title:"操作",width:200,methods:[{title:"操作",callback:"action",slot:!0,slotTemplate:"action"}]};function A(t){w("selectTableChange",{...t[0],___type:"shops"})}function W(t){const{storeStatus:e}=i.value;i.value={...i.value,...t},i.value.storeStatus=e,d()}function G(){x.push({name:"add-shop",query:{type:"SUPPLIER"}})}function Y(t){h.confirm({title:"确认关闭",content:`您确认要关闭店铺${t.storeName}?`,alignCenter:!1,onOk:async()=>{(await N(t.id,"SUPPLIER",{status:"CLOSED"})).data.success&&(R.success("关闭成功"),d(),S.value.init())}})}function j(t){h.confirm({title:"确认开启",content:`您确认要开启店铺${t.storeName}?`,alignCenter:!1,onOk:async()=>{(await N(t.id,"SUPPLIER",{status:"OPEN"})).data.success&&(R.success("开启成功"),d(),S.value.init())}})}function F(t){x.push({name:"sub-merchant-information",query:{id:t.id,name:t.storeName,type:"supplier"}})}function H(t){t.___selected=!t.___selected;const e=m.value.find(n=>n.id===t.id);e&&e.id?m.value.forEach((n,C)=>{n.id===e.id&&m.value.splice(C,1)}):m.value.push(t),w("callback",t)}function J(t){f.value=t.map(e=>(e.___selected=!1,m.value.length!==0?m.value.map(n=>(n.id===e.id&&(e.___selected=!0),n)):e.___selected=!1,e))}function d(){se(i.value).then(t=>{t.data.success&&(y.value=t.data.result,J(t.data.result.records))})}function K(){f.value&&f.value.length&&(f.value=f.value.map(t=>(t.___selected=!1,t)))}return U({selectedStore:v,init:K}),ue(()=>{d()}),ce(()=>v.value,t=>{L.width=t?400:100},{deep:!0,immediate:!0}),(t,e)=>{const n=r("a-tab-pane"),C=r("a-tabs"),u=r("a-button"),Q=r("a-space"),X=r("a-col"),Z=r("a-row"),ee=r("a-image"),te=r("a-pagination"),ae=r("a-card");return g(),b(ae,{class:"general-card",title:k?"TOB店铺列表":"",bordered:!1},{default:o(()=>[k?(g(),b(C,{key:0,"default-active-key":l(z),onChange:e[0]||(e[0]=a=>{l(i).storeStatus=a,d()})},{default:o(()=>[s(n,{key:"OPEN",title:"开启中"}),s(n,{key:"CLOSED",title:"店铺关闭"}),s(n,{key:"APPLY",title:"申请开店"}),s(n,{key:"REFUSED",title:"审核拒绝"}),s(n,{key:"APPLYING",title:"待审核"})]),_:1},8,["default-active-key"])):P("",!0),s(l(le),{"row-span":k?0:12,columns:B,onReset:W,onSearch:e[1]||(e[1]=a=>{i.value={...l(i),...a},d()})},null,8,["row-span"]),s(Z,{style:{"margin-bottom":"16px"}},{default:o(()=>[s(X,{span:16},{default:o(()=>[s(Q,null,{default:o(()=>[s(u,{type:"primary",onClick:e[2]||(e[2]=a=>G())},{default:o(()=>e[5]||(e[5]=[c(" 添加 ")])),_:1})]),_:1})]),_:1})]),_:1}),s(l(ie),{ref_key:"tablePageRef",ref:S,columns:q,methods:L,"data-list":l(f),bordered:!0,"enable-pagination":!1,onSelectTableChange:A},{storeLogo:o(({data:a})=>[s(ee,{width:"60",src:a.storeLogo},null,8,["src"])]),action:o(({data:a})=>[O("div",me,[l(v)?(g(),$("div",_e,[s(u,{type:"text",status:"success",onClick:_=>t.$openWindow({name:"shop-detail",query:{id:a.id,type:"SUPPLIER"}})},{default:o(()=>e[6]||(e[6]=[c(" 查看 ")])),_:2},1032,["onClick"]),s(u,{type:"text",status:"danger",onClick:_=>t.$openWindow({name:"clerk-manage",query:{id:a.id,type:"supplier"}})},{default:o(()=>e[7]||(e[7]=[c(" 店员 ")])),_:2},1032,["onClick"]),s(u,{type:"text",status:"warning",onClick:_=>t.$openWindow({name:"add-shop",query:{id:a.id,type:"SUPPLIER"}})},{default:o(()=>e[8]||(e[8]=[c(" 修改 ")])),_:2},1032,["onClick"]),s(u,{type:"text",status:"",onClick:_=>F(a)},{default:o(()=>e[9]||(e[9]=[c(" 结算设置 ")])),_:2},1032,["onClick"]),a.storeStatus==="OPEN"?(g(),b(u,{key:0,type:"text",status:"danger",onClick:_=>Y(a)},{default:o(()=>e[10]||(e[10]=[c(" 关闭 ")])),_:2},1032,["onClick"])):P("",!0),a.storeStatus==="CLOSED"?(g(),b(u,{key:1,type:"text",status:"success",onClick:_=>j(a)},{default:o(()=>e[11]||(e[11]=[c(" 开启 ")])),_:2},1032,["onClick"])):P("",!0)])):(g(),$("div",ge,[s(u,{type:"text",status:a.___selected?"danger":"",onClick:_=>H(a)},{default:o(()=>[c(pe(a.___selected?"已选择":"选择"),1)]),_:2},1032,["status","onClick"])]))])]),_:1},8,["data-list"]),O("div",ye,[s(te,{total:l(y).total,current:l(y).number,"page-size":l(y).size,"show-page-size":"",onChange:e[3]||(e[3]=a=>{l(i).pageNumber=a,d()}),onPageSizeChange:e[4]||(e[4]=a=>{l(i).pageSize=a,d()})},null,8,["total","current","page-size"])])]),_:1},8,["title"])}}}),we=fe(be,[["__scopeId","data-v-dc0da60d"]]);export{we as default};
