import{g as T,a as m}from"./goods-CB7YWqUH.js";import{u as A}from"./useCurrentInstance-BLlvmEjv.js";import{c as D}from"./tools-BfzgO_2s.js";import{U as N,V as E}from"./dist-PezRi_EG.js";import{d as O,r as p,n as F,b as f,o as U,j as V,w as g,e as r,u as a,f as B,M as c}from"./index-C4AMdMz2.js";const J=O({__name:"list",emits:["selectTableChange"],setup(G,{emit:h}){var b;const _=h,o=p(),x=F(),i=(b=A().globalProperties)==null?void 0:b.$modal;function y(e){x.push({name:"goodsdetail",query:{id:e.record.id}})}const k=[{label:"商品名称",model:"goodsName",disabled:!1,input:!0},{label:"商品编号",model:"id",disabled:!1,input:!0}],C=[{title:"编号",dataIndex:"id"},{title:"商品",dataIndex:"goodsName",slot:!0,slotData:{goods:{goodsName:"goodsName",goodsImage:"original"}}},{title:"商品价格",dataIndex:"price",currency:!0},{title:"审核状态",dataIndex:"authFlag",slot:!0,slotData:{badge:D}},{title:"店铺名称",dataIndex:"storeName"}],I={title:"操作",width:300,methods:[{title:"通过",callback:"pass",type:"text",status:"success"},{title:"拒绝",callback:"refuse",type:"text",status:"danger"},{title:"查看",callback:"detail",type:"text"}]},s=p({authFlag:"TOBEAUDITED",scene:"STORE"}),n=p([]);function S(e){i.confirm({title:"确认审核",content:"您确认要通过审核?",alignCenter:!1,onOk:async()=>{const t={goodsIds:[e.record.id],goodsAuth:"PASS"};(await m(t)).data.success&&(c.success("审核成功"),o.value.init())}})}function v(e){i.confirm({title:"确认审核",content:"您确认要拒绝？",alignCenter:!1,onOk:async()=>{const t={goodsIds:[e.record.id],goodsAuth:"REFUSE"};(await m(t)).data.success&&(c.success("审核成功"),o.value.init())}})}function P(e){_("selectTableChange",{...e[0],___type:"goods"}),n.value=e}function w(){if(n.value.length<=0){c.error("您还未选择要审核的商品");return}i.confirm({title:"确认审核",content:`您确认要审核所选的${n.value.length}个商品`,alignCenter:!1,onOk:async()=>{const e=[];n.value.forEach(d=>{e.push(d.id)}),(await m({goodsIds:e,goodsAuth:"PASS"})).data.success&&(c.success("审核成功"),o.value.init())}})}return(e,t)=>{const l=f("a-button"),d=f("a-row"),R=f("a-card");return U(),V(R,{class:"general-card",title:"商品审核",bordered:!1},{default:g(()=>[r(a(N),{columns:k,onReset:t[0]||(t[0]=u=>{s.value={...a(s),...u}}),onSearch:t[1]||(t[1]=u=>{s.value={...a(s),...u}})}),r(d,{style:{"margin-bottom":"16px"}},{default:g(()=>[r(l,{type:"primary",onClick:w},{default:g(()=>t[2]||(t[2]=[B(" 批量审核 ")])),_:1})]),_:1}),r(a(E),{ref_key:"tablePageRef",ref:o,columns:C,methods:I,api:a(T),"api-params":a(s),bordered:!0,checkbox:!0,onDetail:y,onRefuse:v,onPass:S,onSelectTableChange:P},null,8,["api","api-params"])]),_:1})}}});export{J as default};
