import{d as P,r,a as $,b as i,o as j,j as B,w as o,e as n,f,u as s,bx as L,t as U,by as N,bz as z,M as u,bA as x}from"./index-C4AMdMz2.js";import{u as H}from"./useCurrentInstance-BLlvmEjv.js";import{R as Q,V as q}from"./validator-B8pIxTAL.js";import{V as F}from"./dist-PezRi_EG.js";const Z=P({__name:"index",setup(G){var y;const d=r(),v=(y=H().globalProperties)==null?void 0:y.$modal,g=r(),c=r([]),m=r(""),p=r(""),k=[{title:"敏感词",dataIndex:"sensitiveWord"},{title:"创建时间",dataIndex:"createTime"},{title:"更新时间",dataIndex:"updateTime"},{title:"操作人",dataIndex:"createBy"}],w={title:"操作",width:300,fixed:"right",methods:[{title:"修改",callback:"editor",type:"text",status:"warning"},{title:"删除",callback:"delete",type:"text",status:"danger"}]},t=$({enableAddModal:!1,formLoading:!1,fid:"",form:{sensitiveWord:""}});function A(){t.enableAddModal=!0,p.value="添加",t.fid="",Object.keys(t.form).forEach(a=>{t.form[a]=""})}async function C(){var e;if(!await((e=g.value)==null?void 0:e.validate())){let l;if(!t.fid)l=await N(t.form);else{const _={id:t.fid,sensitiveWord:t.form.sensitiveWord};l=await z(t.fid,_)}l.data.success&&(u.success(`${t.fid?"修改":"添加"}成功!`),t.enableAddModal=!1,d.value.init())}}function W(a){p.value="编辑",a&&(Object.keys(a.record).forEach(e=>{t.form[e]=a.record.hasOwnProperty(e)?a.record[e]:""}),t.fid=a.record.id,t.enableAddModal=!0)}function M(a){v.confirm({title:"确认删除",content:`您确认要删除${a.record.sensitiveWord}?`,alignCenter:!1,onOk:async()=>{(await x(a.record.id)).data.success&&(u.success("删除成功"),d.value.init())}})}function R(a){c.value=a}function V(){if(c.value.length<=0){u.error("您还未选择要删除的数据");return}c.value.forEach(e=>{m.value+=`${e.id},`});const a=m.value.substring(0,m.value.length-1);v.confirm({title:"确认删除",content:`您确认要删除所选的${c.value.length}条数据?`,alignCenter:!1,onOk:async()=>{(await x(a)).data.success&&(u.success("删除成功"),d.value.init())}})}return(a,e)=>{const l=i("a-button"),_=i("a-space"),E=i("a-col"),S=i("a-row"),I=i("a-input"),h=i("a-form-item"),O=i("a-form"),T=i("a-modal"),D=i("a-card");return j(),B(D,{class:"general-card",title:"敏感词",bordered:!1},{default:o(()=>[n(S,{style:{"margin-bottom":"16px"}},{default:o(()=>[n(E,{span:16},{default:o(()=>[n(_,null,{default:o(()=>[n(l,{type:"primary",onClick:A},{default:o(()=>e[2]||(e[2]=[f(" 添加 ")])),_:1}),n(l,{onClick:V},{default:o(()=>e[3]||(e[3]=[f(" 批量删除 ")])),_:1})]),_:1})]),_:1})]),_:1}),n(s(F),{ref_key:"tablePageRef",ref:d,columns:k,methods:w,api:s(L),checkbox:!0,bordered:!0,onEditor:W,onDelete:M,onSelectTableChange:R},null,8,["api"]),n(T,{visible:s(t).enableAddModal,"onUpdate:visible":e[1]||(e[1]=b=>s(t).enableAddModal=b),"align-center":!1,footer:!1},{title:o(()=>[f(U(s(p)),1)]),default:o(()=>[n(O,{ref_key:"formRef",ref:g,model:s(t).form,onSubmit:C},{default:o(()=>[n(h,{field:"sensitiveWord",label:"敏感词",rules:[s(Q),s(q)],"validate-trigger":["change"]},{default:o(()=>[n(I,{modelValue:s(t).form.sensitiveWord,"onUpdate:modelValue":e[0]||(e[0]=b=>s(t).form.sensitiveWord=b)},null,8,["modelValue"])]),_:1},8,["rules"]),n(h,{label:"操作"},{default:o(()=>[n(l,{loading:s(t).formLoading,"html-type":"submit",type:"primary"},{default:o(()=>e[4]||(e[4]=[f(" 保存 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])]),_:1})}}});export{Z as default};
