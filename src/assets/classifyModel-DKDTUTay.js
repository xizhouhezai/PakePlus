import{O as L,P as W}from"./goods-CB7YWqUH.js";import{_ as X}from"./index.vue_vue_type_script_setup_true_lang-DsrWKjKu.js";import{R as k}from"./validator-B8pIxTAL.js";import{d as Y,r as s,b as i,o as w,c as ee,e as a,w as o,f as r,t as B,u as l,k as d,Z as x,j as N,s as S,q as C,F as le,M as T,_ as te}from"./index-C4AMdMz2.js";import"./index-CzBKN9cw.js";import"./index--a7kHzzJ.js";import"./useCurrentInstance-BLlvmEjv.js";import"./dist-PezRi_EG.js";import"./extra-5DUayDl9.js";const ae=["src"],oe={style:{"text-align":"right"}},ne=["src"],se={style:{"text-align":"right"}},ie=Y({__name:"classifyModel",emits:["refresh"],setup(de,{expose:$,emit:E}){const O=E,p=s(!1),U=s(0),h=s(!1),f=s(!1),y=s(),u=s(!1),I=s(),R=s(""),F=s(""),t=s({parentId:0,level:0,image:"",sortOrder:0,commissionRate:0,deleteFlag:0,name:"",id:""});function g(){y.value.resetFields(),f.value=!1}function z(){u.value=!0}function D(){f.value=!1}function P(){g()}function j(){u.value=!1}function q(){u.value=!1}function A(){u.value=!1,t.value.image=I.value}function Q(b){I.value=b.url}async function Z(){var e;await((e=y.value)==null?void 0:e.validate())||(U.value===0?L(t.value).then(v=>{v.data.code===200&&(T.success("添加成功"),O("refresh"),g())}):W(t.value).then(v=>{v.data.code===200&&(T.success("修改成功"),O("refresh"),g())}))}return $({visible:f,showParent:h,parentTitle:R,modalTitle:F,formAdd:t,modalType:U}),(b,e)=>{const v=i("a-alert"),_=i("a-input"),m=i("a-form-item"),G=i("icon-eye"),c=i("a-button"),H=i("a-tooltip"),M=i("a-input-number"),J=i("a-switch"),K=i("a-form"),V=i("a-modal");return w(),ee(le,null,[a(V,{visible:l(f),"onUpdate:visible":e[8]||(e[8]=n=>C(f)?f.value=n:null),width:500,onOk:D,onCancel:P},{title:o(()=>[r(B(l(F)),1)]),footer:o(()=>[d("div",oe,[a(c,{style:{"margin-right":"5px"},onClick:g},{default:o(()=>e[16]||(e[16]=[r(" 取消 ")])),_:1}),a(c,{type:"primary",onClick:Z},{default:o(()=>e[17]||(e[17]=[r(" 提交 ")])),_:1})])]),default:o(()=>[d("div",null,[a(v,{"mb-10px":"",title:"提示",type:"warning"},{default:o(()=>[d("div",{class:x(l(t).level===0?"font-bold":"")}," • 一级分类名称：最多支持 8 个字符。 ",2),d("div",{class:x(l(t).level===1?"font-bold":"")}," • 二级分类名称：最多支持 4 个字符。 ",2),d("div",{class:x(l(t).level===2?"font-bold":"")}," • 三级分类名称：最多支持 4 个字符。 ",2)]),_:1}),a(K,{ref_key:"formRef",ref:y,model:l(t),style:{width:"400px"},layout:"horizontal","auto-label-width":""},{default:o(()=>[l(h)?(w(),N(m,{key:0,field:"parentId","validate-trigger":["change","input"],label:"上级分类"},{default:o(()=>[r(B(l(R))+" ",1),a(_,{modelValue:l(t).parentId,"onUpdate:modelValue":e[0]||(e[0]=n=>l(t).parentId=n),style:{width:"320px"},"allow-clear":"",class:"hideInput"},null,8,["modelValue"])]),_:1})):S("",!0),a(m,{field:"level",label:"层级",class:"hideInput"},{default:o(()=>[a(_,{modelValue:l(t).level,"onUpdate:modelValue":e[1]||(e[1]=n=>l(t).level=n)},null,8,["modelValue"])]),_:1}),a(m,{field:"name",label:"分类名称",rules:[l(k)]},{default:o(()=>[a(_,{modelValue:l(t).name,"onUpdate:modelValue":e[2]||(e[2]=n=>l(t).name=n),"max-length":l(t).level!==0?4:8,"show-word-limit":""},null,8,["modelValue","max-length"])]),_:1},8,["rules"]),l(t).level!==1?(w(),N(m,{key:1,field:"image",label:"分类图标"},{default:o(()=>[a(_,{modelValue:l(t).image,"onUpdate:modelValue":e[3]||(e[3]=n=>l(t).image=n),readonly:""},null,8,["modelValue"]),a(H,null,{content:o(()=>[d("div",null,[d("img",{src:l(t).image,alt:"该资源不存在",style:{width:"100%",margin:"0 auto"}},null,8,ae),d("a",{style:{"margin-top":"5px","text-align":"right",cursor:"pointer"},onClick:e[4]||(e[4]=n=>p.value=!0)},"查看大图")])]),default:o(()=>[a(c,null,{default:o(()=>[a(G)]),_:1})]),_:1}),a(c,{type:"primary",onClick:z},{default:o(()=>e[13]||(e[13]=[r(" 上传图片 ")])),_:1})]),_:1})):S("",!0),a(m,{field:"sortOrder",label:"排序值",rules:[l(k)]},{default:o(()=>[a(M,{modelValue:l(t).sortOrder,"onUpdate:modelValue":e[5]||(e[5]=n=>l(t).sortOrder=n),style:{width:"320px"},class:"input-demo",min:10,max:999},null,8,["modelValue"])]),_:1},8,["rules"]),a(m,{label:"佣金比例(%)",field:"commissionRate",rules:[l(k)]},{default:o(()=>[a(M,{modelValue:l(t).commissionRate,"onUpdate:modelValue":e[6]||(e[6]=n=>l(t).commissionRate=n),style:{width:"320px"},class:"input-demo",min:10,max:100},null,8,["modelValue"])]),_:1},8,["rules"]),a(m,{label:"是否启用",field:"deleteFlag"},{default:o(()=>[a(J,{modelValue:l(t).deleteFlag,"onUpdate:modelValue":e[7]||(e[7]=n=>l(t).deleteFlag=n),"checked-value":0,"unchecked-value":1},{checked:o(()=>e[14]||(e[14]=[r(" 启用 ")])),unchecked:o(()=>e[15]||(e[15]=[r(" 禁用 ")])),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])])]),_:1},8,["visible"]),a(V,{visible:l(u),"onUpdate:visible":e[9]||(e[9]=n=>C(u)?u.value=n:null),width:1100,title:"oss资源管理",onOk:A,onCancel:e[10]||(e[10]=n=>u.value=!1)},{default:o(()=>[a(X,{"is-single":!0,onSelected:Q})]),_:1},8,["visible"]),a(V,{visible:l(p),"onUpdate:visible":e[12]||(e[12]=n=>C(p)?p.value=n:null),width:1100,onOk:j,onCancel:q},{footer:o(()=>[d("div",se,[a(c,{type:"text",onClick:e[11]||(e[11]=n=>p.value=!1)},{default:o(()=>e[18]||(e[18]=[r(" 关闭 ")])),_:1})])]),default:o(()=>[d("img",{src:l(t).image,alt:"该资源不存在",style:{width:"100%",margin:"0 auto",display:"block"}},null,8,ne)]),_:1},8,["visible"])],64)}}}),ye=te(ie,[["__scopeId","data-v-ab046477"]]);export{ye as default};
