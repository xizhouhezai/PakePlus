import{f as A}from"./statisitics-CehHs8Ha.js";import{u as B}from"./loading-CB2rs24d.js";import{C as D}from"./index-DVwIKmiX.js";import{d as y,a as L,E as w,b,o as u,c as C,e as d,w as m,k as Q,u as l,_ as E,r as _,A as f,j as T,s as k}from"./index-C4AMdMz2.js";import{_ as N}from"./index.vue_vue_type_script_setup_true_lang-DQl3Ouxv.js";import"./index.vue_vue_type_script_setup_true_lang-CDd49swx.js";import"./index-Dg8m97qn.js";import"./shops-fXVW_gE8.js";import"./useCurrentInstance-BLlvmEjv.js";import"./tools-BfzgO_2s.js";import"./validator-B8pIxTAL.js";import"./dist-PezRi_EG.js";import"./index-D43NcXdt.js";const O=y({__name:"index",props:{res:null},setup(p){const a=p,{loading:i}=B(),e=L({chartList:[],previewChart:null,uvs:0,pvs:0});function s(){const o=[],t=[];(e.chartList||[]).forEach(v=>{const g=v.createDate||"",x=v.newlyAdded??0,I=v.activeQuantity??0;o.push({date:g,newlyAdded:x,title:"新增会员数量",actives:x}),t.push({date:g,activeQuantity:I,actives:I,title:"当日活跃数量"})});const r=[...o,...t],c=e.previewChart;c&&(c.data(r),c.scale({activeQuantity:{range:[0,1],nice:!0}}),c.tooltip({showCrosshairs:!0,shared:!0}),c.line().position("date*actives").color("title").label("actives").shape("smooth"),c.point().position("date*actives").color("title").label("actives").shape("circle").style({stroke:"#fff",lineWidth:1}),c.area().position("date*actives").color("title").shape("smooth"),c.render())}async function h(){const o=a.res;e.chartList=a.res,o.length?o.forEach(t=>{e.uvs+=t.newlyAdded,e.pvs+=t.activeQuantity}):(e.uvs=0,e.pvs=0),e.previewChart&&(e.previewChart.destroy(),e.previewChart=null),e.previewChart=new D({container:"previewChart",autoFit:!0,height:500,padding:[70,70,70,70]}),s()}return w(()=>a.res,()=>{setTimeout(()=>{h()},100)},{immediate:!0,deep:!0}),(o,t)=>{const n=b("a-spin");return u(),C("div",null,[d(n,{style:{display:"block"},loading:l(i)},{default:m(()=>t[0]||(t[0]=[Q("div",{id:"previewChart"},null,-1)])),_:1},8,["loading"])])}}}),S=E(O,[["__scopeId","data-v-00cfb3fc"]]),V={style:{height:"100%"}},$=y({__name:"list",props:{res:null},setup(p){const a=p,i=[{title:"日期",dataIndex:"createDate"},{title:"当前会员",dataIndex:"memberCount"},{title:"新增会员",dataIndex:"newlyAdded"},{title:"活跃会员",dataIndex:"activeQuantity"}],e=L({chartList:[]});async function s(){e.chartList=a.res}return w(()=>a.res,()=>{s()},{deep:!0,immediate:!0}),(h,o)=>{const t=b("a-table");return u(),C("div",V,[d(t,{columns:i,data:l(e).chartList,stripe:""},null,8,["data"])])}}}),R=E($,[["__scopeId","data-v-72557f1a"]]),W={class:"preview-chart"},Z=y({__name:"member",props:{isInline:{type:Boolean,default:!1}},setup(p){const a=p,i=_(null),e=_({month:"",recent:"LAST_SEVEN"}),s=_({searchType:e.value.searchType});function h(t){e.value={...t}}async function o(t){try{const n=await A(t);n.data.success&&(i.value=n.data.result)}catch(n){console.error("Error fetching order chart data:",n)}}return w(()=>e.value,t=>{if(s.value.searchType=t.recent,t.month){const[n,r]=t.month.split("-");s.value.year=n,s.value.month=r!=null&&r.startsWith("0")?r.substring(1):r}else delete s.value.month,delete s.value.year;o(s.value)},{deep:!0,immediate:!0}),(t,n)=>{const r=b("a-card");return u(),C("div",W,[d(r,{title:"会员统计",bordered:!a.isInline,style:f({width:"100%",marginBottom:a.isInline?"0px":"20px"}),hoverable:""},{default:m(()=>[d(N,{"date-type":l(e).date,onOnChange:h},null,8,["date-type"])]),_:1},8,["bordered","style"]),d(r,{hoverable:"",title:"客户增长趋势",bordered:!a.isInline,style:f({width:"100%",marginTop:a.isInline?"0px":"20px"})},{default:m(()=>[l(i)?(u(),T(S,{key:0,res:l(i)},null,8,["res"])):k("",!0)]),_:1},8,["bordered","style"]),d(r,{hoverable:"",title:"客户增长报表",bordered:!a.isInline,style:f({width:"100%",marginTop:a.isInline?"0px":"20px"})},{default:m(()=>[l(i)?(u(),T(R,{key:0,res:l(i)},null,8,["res"])):k("",!0)]),_:1},8,["bordered","style"])])}}});export{Z as default};
