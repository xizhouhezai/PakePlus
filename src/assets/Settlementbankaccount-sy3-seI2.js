import{e as ve,f as _e,h as be,i as ke}from"./shops-fXVW_gE8.js";import{d as ye,D as we,r as d,U as xe,h as Ve,E as y,b as p,o as w,c as x,e as a,w as t,u as o,f as i,k as u,q as B,F as X,i as Y,t as N,_ as Be}from"./index-C4AMdMz2.js";import{R as L}from"./validator-B8pIxTAL.js";const ge={flex:"","flex-j-c":"","flex-a-c":""},Ce={key:0},Ue={class:"bank-list"},Le={class:"bank-list"},De={key:1},Fe=ye({__name:"Settlementbankaccount",props:{submitFrom:{type:Object,default:()=>{}},verifyDetail:{type:Boolean,default:!1}},setup(Z,{expose:ee}){const h=Z,A=we(),M=d(""),s=d({account_info:{}}),b=d(!1),g=d(1),E=d(!1),c=d("0"),V=d([]),D=d([]),F=d([]),I=d([]),R=d(""),$=d(""),C=d(!1),O=d([]),ae=d([]),v=d([]),_=d(""),P=d(""),j=d(1e3),q=xe(()=>A.bankList);async function Q(){let n,e;if(c.value==="0"&&!q.value.companyBankList.length)try{b.value=!0,n=await _e(),b.value=!1,e="companyBankList"}catch(f){console.warn(f),b.value=!1}else if(c.value==="1"&&!q.value.personalBankList.length)try{b.value=!0,n=await be(),b.value=!1,e="personalBankList"}catch(f){console.warn(f),b.value=!1}if(n&&n.data.success)A.setBankList({label:e,value:n.data.result}),F.value=n.data.result,V.value=n.data.result.slice(0,j.value);else{const f=c.value==="0"?"companyBankList":"personalBankList";F.value=q.value[f],V.value=q.value[f].slice(0,j.value)}}function G(){C.value=!0,Q()}function le(){window.open("https://pay.weixin.qq.com/wiki/doc/apiv3_partner/terms_definition/chapter1_1_3.shtml#part-4")}function ne(){window.open("https://pay.weixin.qq.com/wiki/doc/apiv3_partner/terms_definition/chapter1_1_3.shtml")}function H(){window.open("https://pay.weixin.qq.com/wiki/doc/apiv3_partner/terms_definition/chapter1_1_3.shtml#part-6")}function te(){window.open("https://pay.weixin.qq.com/wiki/doc/apiv3_partner/terms_definition/chapter1_1_3.shtml#part-4")}function oe(n){_.value=n,s.value.account_info.account_bank=n.account_bank,s.value.account_info.bank_address_code=n.account_bank_code}function ue(n){P.value=n,s.value.account_info.bank_name=n.bank_branch_name,s.value.account_info.bank_branch_id=n.bank_branch_id}function J(n,e){const f=["",...n,""].join(".*"),k=new RegExp(f);e==="bank"?V.value=F.value.filter(r=>k.test(r.bank_alias)):D.value=I.value.filter(r=>k.test(r.bank_branch_name))}async function ie(){var e;return!await((e=M.value)==null?void 0:e.validate())}ee({checkoutForm:ie});async function se(){const n=await ve();if(n.data.success){const e=n.data.result.map(f=>({label:f.province_name,value:`${f.province_code}`,children:f.citiesList.map(k=>({label:k.city_name,value:`${k.city_code}`}))}));ae.value=e,O.value=e}}async function K(){if(v.value.length&&_.value.bank_alias_code){const n=await ke({cityCode:v.value[v.value.length-1],bankAliasCode:_.value.bank_alias_code});n.data.success&&(E.value=!!n.data.result.length,D.value=n.data.result,I.value=n.data.result)}}return Ve(()=>{se()}),y(()=>h.submitFrom,n=>{s.value=n},{immediate:!0,deep:!0}),y(()=>g.value,n=>{n?s.value.account_info.account_bank="":(s.value.account_info.bank_branch_id="",s.value.account_info.account_bank="其他银行")},{deep:!0}),y(()=>$,n=>{n?J(n.value,"branch"):D.value=I.value},{deep:!0}),y(()=>R,n=>{n?J(n.value,"bank"):V.value=F.value.slice(0,j.value)},{deep:!0}),y(()=>c,()=>{V.value=[],setTimeout(()=>{Q()},300)},{deep:!0}),y(()=>v,n=>{n&&_.value&&_.value.bank_alias_code&&K()},{deep:!0}),y(()=>_,n=>{n&&v.value.length&&K()},{deep:!0}),(n,e)=>{const f=p("a-option"),k=p("a-select"),r=p("a-form-item"),m=p("a-input"),S=p("a-button"),U=p("a-link"),de=p("a-form"),z=p("a-radio"),W=p("a-radio-group"),re=p("a-cascader"),fe=p("a-spin"),pe=p("a-Form"),me=p("a-modal");return w(),x("div",null,[a(de,{ref_key:"SettlementbankaccountFromRef",ref:M,model:o(s),disabled:h.verifyDetail},{default:t(()=>[a(r,{field:"account_info.bank_account_type",label:"账户类型",rules:[o(L)]},{default:t(()=>[a(k,{modelValue:o(s).account_info.bank_account_type,"onUpdate:modelValue":e[0]||(e[0]=l=>o(s).account_info.bank_account_type=l),style:{width:"280px"},placeholder:"请选择账户类型"},{default:t(()=>[a(f,{value:"74"},{default:t(()=>e[20]||(e[20]=[i(" 对公账户 ")])),_:1}),a(f,{value:"75"},{default:t(()=>e[21]||(e[21]=[i(" 对私账户 ")])),_:1})]),_:1},8,["modelValue"])]),_:1},8,["rules"]),a(r,{field:"account_info.account_bank",label:"开户银行",rules:[o(L)]},{extra:t(()=>[u("div",null,[u("p",null,[e[24]||(e[24]=i(" 1、17家直连银行，请根据")),a(U,{hoverable:!1,style:{"font-size":"12px"},onClick:e[2]||(e[2]=l=>le())},{default:t(()=>e[23]||(e[23]=[i(" 对照表 ")])),_:1}),e[25]||(e[25]=i("直接填写银行名 ; "))]),e[26]||(e[26]=u("p",null,"2、非17家直连银行，该参数请填写为“其他银行”。",-1))])]),default:t(()=>[a(m,{modelValue:o(s).account_info.account_bank,"onUpdate:modelValue":e[1]||(e[1]=l=>o(s).account_info.account_bank=l),style:{width:"400px"},disabled:""},null,8,["modelValue"]),a(S,{style:{"margin-left":"10px"},type:"primary",onClick:G},{default:t(()=>e[22]||(e[22]=[i(" 选择 ")])),_:1})]),_:1},8,["rules"]),a(r,{field:"account_info.bank_address_code",label:"省市编码",rules:[o(L)]},{extra:t(()=>[u("div",null,[u("p",null,[e[28]||(e[28]=i(" 至少精确到市，详细参见")),a(U,{hoverable:!1,style:{"font-size":"12px"},onClick:e[4]||(e[4]=l=>ne())},{default:t(()=>e[27]||(e[27]=[i(" 省市区编号对照表 ")])),_:1}),e[29]||(e[29]=i("。 "))]),e[30]||(e[30]=u("p",{style:{color:"#f00"}}," 注：仅当省市区编号对照表中无对应的省市区编号时，可向上取该银行对应市级编号或省级编号。 ",-1))])]),default:t(()=>[a(m,{modelValue:o(s).account_info.bank_address_code,"onUpdate:modelValue":e[3]||(e[3]=l=>o(s).account_info.bank_address_code=l),style:{width:"400px"},placeholder:"请输入省市编码"},null,8,["modelValue"])]),_:1},8,["rules"]),a(r,{field:"account_info.account_name",label:"开户名称",rules:[o(L)]},{default:t(()=>[a(m,{modelValue:o(s).account_info.account_name,"onUpdate:modelValue":e[5]||(e[5]=l=>o(s).account_info.account_name=l),style:{width:"400px"},placeholder:"请输入开户名称"},null,8,["modelValue"])]),_:1},8,["rules"]),a(r,{field:"account_info.bank_branch_id",label:"联行号"},{extra:t(()=>[u("div",null,[e[34]||(e[34]=u("p",null,"1、17家直连银行无需填写，如为其他银行，则全称（含支行）和联行号二选一。",-1)),u("p",null,[e[32]||(e[32]=i(" 2、详细参见")),a(U,{hoverable:!1,style:{"font-size":"12px"},onClick:e[7]||(e[7]=l=>H())},{default:t(()=>e[31]||(e[31]=[i(" 全称（含支行）对照表 ")])),_:1}),e[33]||(e[33]=i("。 "))])])]),default:t(()=>[a(m,{modelValue:o(s).account_info.bank_branch_id,"onUpdate:modelValue":e[6]||(e[6]=l=>o(s).account_info.bank_branch_id=l),style:{width:"400px"},placeholder:"请输入联行号"},null,8,["modelValue"])]),_:1}),a(r,{field:"account_info.bank_name",label:"全称（含支行）"},{extra:t(()=>[u("div",null,[e[39]||(e[39]=u("p",null,"1、17家直连银行无需填写，如为其他银行，则全称（含支行）和 联行号二选一。",-1)),u("p",null,[e[37]||(e[37]=i(" 2、详细参见")),a(U,{hoverable:!1,style:{"font-size":"12px"},onClick:e[9]||(e[9]=l=>H())},{default:t(()=>e[36]||(e[36]=[i(" 全称（含支行）对照表 ")])),_:1}),e[38]||(e[38]=i("。 "))])])]),default:t(()=>[a(m,{modelValue:o(s).account_info.bank_name,"onUpdate:modelValue":e[8]||(e[8]=l=>o(s).account_info.bank_name=l),style:{width:"400px"},disabled:""},null,8,["modelValue"]),a(S,{style:{"margin-left":"10px"},type:"primary",onClick:G},{default:t(()=>e[35]||(e[35]=[i(" 选择 ")])),_:1})]),_:1}),a(r,{field:"account_info.account_number",label:"银行账号",rules:[o(L)]},{extra:t(()=>[u("div",null,[u("p",null,[e[41]||(e[41]=i(" 数字，长度遵循系统支持的")),a(U,{hoverable:!1,style:{"font-size":"12px"},onClick:e[11]||(e[11]=l=>te())},{default:t(()=>e[40]||(e[40]=[i(" 卡号长度要求表 ")])),_:1}),e[42]||(e[42]=i("。 "))])])]),default:t(()=>[a(m,{modelValue:o(s).account_info.account_number,"onUpdate:modelValue":e[10]||(e[10]=l=>o(s).account_info.account_number=l),style:{width:"400px"},placeholder:"请输入银行账号"},null,8,["modelValue"])]),_:1},8,["rules"])]),_:1},8,["model","disabled"]),a(me,{visible:o(C),"onUpdate:visible":e[18]||(e[18]=l=>B(C)?C.value=l:null),width:700,title:"选择银行",onCancel:e[19]||(e[19]=l=>C.value=!1)},{default:t(()=>[u("div",null,[a(pe,null,{default:t(()=>[u("div",ge,[a(W,{"model-value":o(g),"onUpdate:modelValue":e[12]||(e[12]=l=>B(g)?g.value=l:null),style:{"margin-bottom":"20px"}},{default:t(()=>[a(z,{value:1},{default:t(()=>e[43]||(e[43]=[i(" 17家直连银行 ")])),_:1}),a(z,{value:0},{default:t(()=>e[44]||(e[44]=[i(" 非17家直连银行 ")])),_:1})]),_:1},8,["model-value"])]),a(r,{label:"选择地区"},{default:t(()=>[a(re,{"model-value":o(v),"onUpdate:modelValue":e[13]||(e[13]=l=>B(v)?v.value=l:null),options:o(O),style:{width:"260px"},"allow-clear":"","path-mode":!0},null,8,["model-value","options"])]),_:1}),o(g)===1?(w(),x("div",Ce,[a(r,{label:"选择银行"},{default:t(()=>[u("div",null,[a(W,{"model-value":o(c),"onUpdate:modelValue":e[14]||(e[14]=l=>B(c)?c.value=l:null)},{default:t(()=>[a(z,{value:"0"},{default:t(()=>e[45]||(e[45]=[i(" 对公银行 ")])),_:1}),a(z,{value:"1"},{default:t(()=>e[46]||(e[46]=[i(" 对私银行 ")])),_:1})]),_:1},8,["model-value"])])]),_:1}),a(r,null,{default:t(()=>[u("div",null,[a(m,{modelValue:o(R),"onUpdate:modelValue":e[15]||(e[15]=l=>B(R)?R.value=l:null),style:{width:"400px"},placeholder:`请输入搜索${o(c)==="0"?"对公":"对私"}银行`},null,8,["modelValue","placeholder"]),u("div",Ue,[a(fe,{"h-full":"","w-full":"",loading:o(b)},{default:t(()=>[(w(!0),x(X,null,Y(o(V),(l,T)=>(w(),x("div",{key:T,class:"bank-item"},[u("div",null,N(l.bank_alias),1),u("div",null,[a(S,{size:"small",type:o(_).bank_alias===l.bank_alias?"primary":"dashed",onClick:ce=>oe(l)},{default:t(()=>[i(N(o(_).bank_alias===l.bank_alias?"已":"")+"选择 ",1)]),_:2},1032,["type","onClick"])])]))),128))]),_:1},8,["loading"])])])]),_:1}),a(r,{label:"选择支行"},{default:t(()=>[u("div",null,[a(m,{modelValue:o($),"onUpdate:modelValue":e[16]||(e[16]=l=>B($)?$.value=l:null),style:{width:"400px"},disabled:!o(E),placeholder:o(E)?"搜索支行":"请先选择地区和银行"},null,8,["modelValue","disabled","placeholder"]),u("div",Le,[(w(!0),x(X,null,Y(o(D),(l,T)=>(w(),x("div",{key:T,class:"bank-item"},[u("div",null,N(l.bank_branch_name),1),u("div",null,[a(S,{size:"small",type:o(P).bank_branch_id===l.bank_branch_id?"primary":"dashed",onClick:ce=>ue(l)},{default:t(()=>[i(N(o(P).bank_branch_id===l.bank_branch_id?"已":"")+"选择 ",1)]),_:2},1032,["type","onClick"])])]))),128))])])]),_:1})])):(w(),x("div",De,[a(r,{label:"选择银行"},{default:t(()=>e[47]||(e[47]=[i(" 其他银行 ")])),_:1}),a(r,{label:"开户银行行全称（含支行）"},{extra:t(()=>e[48]||(e[48]=[u("div",null,[u("p",null,"示例值：施秉县农村信用合作联社城关信用社")],-1)])),default:t(()=>[a(m,{modelValue:o(s).account_info.bank_name,"onUpdate:modelValue":e[17]||(e[17]=l=>o(s).account_info.bank_name=l),style:{width:"400px"}},null,8,["modelValue"])]),_:1})]))]),_:1})])]),_:1},8,["visible"])])}}}),Se=Be(Fe,[["__scopeId","data-v-df163084"]]);export{Se as default};
