import{g as B,s as R}from"./operation-CQQGRn8-.js";import{d as D,r as V,h as M,b as u,o as x,c as v,e as t,w as l,f as m,u as s,k as d,F as $,i as F,j as G,t as I,M as p}from"./index-C4AMdMz2.js";const P={style:{"background-color":"#fff"}},X={"text-12px":""},L=D({__name:"experience",setup(j){const b=V(),n=V({form:{consumer:0,register:0,signIn:0,comment:0}});function S(o,e){if(!/^-?\d+$/.test(o)){p.error("请输入正整数");return}n.value.experienceSettingItems.find(i=>i.day===o)?p.error("签到天数不能重复"):n.value.experienceSettingItems[e].day=o}async function y(){const o=await B("EXPERIENCE_SETTING");n.value=o.data.result}function w(){if(n.value.experienceSettingItems.length>=4)return p.error("最多设置4项签到设置"),!1;n.value.experienceSettingItems.push({experience:"0",day:n.value.experienceSettingItems.length})}function k(o){n.value.experienceSettingItems.splice(o,1)}async function C(){let o=!1;const e=new Set;for(const r of n.value.experienceSettingItems)e.has(r.day)&&(o=!0),e.add(r.day);if(o){p.error("签到天数不能重复");return}(await R("EXPERIENCE_SETTING",n.value)).data.success&&(p.success("设置成功!"),y())}return M(()=>{y()}),(o,e)=>{const _=u("a-divider"),r=u("a-input-number"),i=u("a-form-item"),c=u("a-button"),E=u("a-space"),N=u("a-col"),T=u("a-row"),U=u("a-form");return x(),v("div",P,[t(U,{ref_key:"formRef",ref:b,style:{padding:"30px"},model:s(n),layout:"horizontal","auto-label-width":""},{default:l(()=>[t(_,{orientation:"left"},{default:l(()=>e[4]||(e[4]=[m(" 经验值设置 ")])),_:1}),t(T,{gutter:24},{default:l(()=>[t(N,{span:12},{default:l(()=>[t(i,{field:"consumer",label:"消费1元赠送经验值","validate-trigger":["change"]},{default:l(()=>[t(r,{modelValue:s(n).money,"onUpdate:modelValue":e[0]||(e[0]=a=>s(n).money=a),min:0,max:9999,"allow-clear":""},{append:l(()=>e[5]||(e[5]=[d("span",null,"经验值",-1)])),_:1},8,["modelValue"])]),_:1}),t(i,{field:"register",label:"注册账号","validate-trigger":["change"]},{default:l(()=>[t(r,{modelValue:s(n).register,"onUpdate:modelValue":e[1]||(e[1]=a=>s(n).register=a),min:0,max:9999,"allow-clear":""},{append:l(()=>e[6]||(e[6]=[d("span",null,"经验值",-1)])),_:1},8,["modelValue"])]),_:1}),t(i,{field:"signIn",label:"每日签到经验值","validate-trigger":["change"]},{default:l(()=>[t(r,{modelValue:s(n).signIn,"onUpdate:modelValue":e[2]||(e[2]=a=>s(n).signIn=a),min:0,max:9999,"allow-clear":""},{append:l(()=>e[7]||(e[7]=[d("span",null,"经验值",-1)])),_:1},8,["modelValue"])]),_:1}),t(i,{field:"comment",label:"订单评价赠送经验值","validate-trigger":["change"]},{default:l(()=>[t(r,{modelValue:s(n).comment,"onUpdate:modelValue":e[3]||(e[3]=a=>s(n).comment=a),min:0,max:9999,"allow-clear":""},{append:l(()=>e[8]||(e[8]=[d("span",null,"经验值",-1)])),_:1},8,["modelValue"])]),_:1}),(x(!0),v($,null,F(s(n).experienceSettingItems,(a,f)=>(x(),G(i,{key:f,label:`签到设置${f+1}`},{default:l(()=>[t(E,null,{default:l(()=>[t(r,{"w-100px":"",min:1,max:9999,"model-value":a.day,onChange:g=>S(g,f)},null,8,["model-value","onChange"]),t(r,{modelValue:a.experience,"onUpdate:modelValue":g=>a.experience=g,"w-100px":"",min:0,max:99999},null,8,["modelValue","onUpdate:modelValue"]),t(c,{ghost:"",type:"primary",onClick:g=>k(f)},{default:l(()=>e[9]||(e[9]=[m(" 删除 ")])),_:2},1032,["onClick"]),d("span",X,[e[10]||(e[10]=m("签到")),d("span",null,I(a.day),1),e[11]||(e[11]=m("天，赠送")),d("span",null,I(a.experience),1),e[12]||(e[12]=m("经验值"))])]),_:2},1024)]),_:2},1032,["label"]))),128)),t(i,{label:"操作"},{default:l(()=>[t(c,{type:"primary",onClick:w},{default:l(()=>e[13]||(e[13]=[m(" 添加 ")])),_:1})]),_:1}),t(i,null,{default:l(()=>[t(c,{type:"primary",onClick:C},{default:l(()=>e[14]||(e[14]=[m(" 保存 ")])),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])])}}});export{L as _};
