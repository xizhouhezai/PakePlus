import{a as W,w as j,H as q}from"./order-HsmDfkng.js";import{u as z}from"./useCurrentInstance-BLlvmEjv.js";import{u as Y}from"./filters-D05Q2eUM.js";import{_ as G,n as P,R as J,$ as Q,W as X,p as Z}from"./tools-BfzgO_2s.js";import{U as ee,V as te}from"./dist-PezRi_EG.js";import{d as ae,p as se,r as p,E as oe,b as i,o as _,j as re,w as o,e as t,u as a,f as m,k as n,t as f,c as y,b7 as le,s as T,F as ne,i as de,M as ie,_ as ue}from"./index-C4AMdMz2.js";const ce={class:"header"},pe={"mr-30px":""},me={style:{color:"#333"}},fe={"mr-30px":""},_e={style:{color:"#333"}},ye={key:0},be={"mx-5px":"","w-full":""},ke={class:"flex"},ve={key:0},he={class:"goods-num","float-right":""},ge={class:"global_color"},xe={style:{color:"red"}},Oe=ae({__name:"list",setup(we){var O;const v=se(),D=(O=z().globalProperties)==null?void 0:O.$modal,b=p("ALL"),r=p({orderType:"NORMAL,VIRTUAL",orderStatus:b.value==="ALL"?"":b.value,sort:"createTime",order:"desc"}),h=p(!1),c=p({unPaidOrder:0,unDeliveredOrder:0,unTakeOrder:0,partsDeliveredOrder:0,deliveredOrder:0,unPickUpOrder:0,afterSaleOrder:0}),S=p(""),E=p(),g=p(),x=p({total:0}),I=[{label:"订单编号",model:"orderSn",disabled:!1,input:!0},{label:"会员昵称",model:"nickname",disabled:!1,input:!0},{label:"下单时间",disabled:!1,datePicker:{type:"range"}},{label:"买家/收货人手机号后四位",model:"consigneeMobile",disabled:!1,input:!0},{label:"收件人姓名",model:"shipName",disabled:!1,input:!0},{label:"商品名称",model:"goodsName",disabled:!1,input:!0},{label:"订单促销类型",model:"orderPromotionType",disabled:!1,select:{options:G}},{label:"订单来源",model:"clientType",disabled:!1,select:{options:P}},{label:"付款方式",model:"paymentMethod",disabled:!1,select:{options:J}},{label:"配送方式",model:"deliveryMethod",disabled:!1,select:{options:Q}}],L=[{title:"订单详情",dataIndex:"goods",slot:!0,slotTemplate:"goods",width:500},{title:"订单来源",dataIndex:"clientType",slot:!0,slotData:{badge:P},width:120},{title:"店铺名称",dataIndex:"storeName",width:200,slot:!0,store:!0},{title:"应付",dataIndex:"flowPrice",currency:!0,width:100},{title:"买家ID",dataIndex:"buyerId",width:150},{title:"买家/收货人",dataIndex:"nickname",width:150,member:!0},{title:"订单促销类型",dataIndex:"orderPromotionType",slot:!0,slotData:{badge:X},width:120},{title:"订单状态",dataIndex:"orderStatus",slot:!0,slotData:{badge:Z},width:120}],C={title:"操作",width:150,methods:[{title:"查看",callback:"orderDetail",type:"text",status:"success"}]};async function A(){const d=await W(r.value);if(d.data.success){const e=[];d.data.result.records&&d.data.result.records.length&&d.data.result.records.forEach(l=>{e.push({...l,customType:"full"}),e.push(l)}),g.value=e,x.value=d.data.result}}async function R(){D.confirm({title:"确认导出",content:"确定要导出订单数据吗？导出功能为异步导出，需要去 运营 - 导出记录 下载",onOk:async()=>{(await j(r.value)).data.success&&ie.success("导出成功,请前往 “运营 - 导出记录” 进行下载")}})}async function N(){if(h.value)return;const d={...r.value,orderStatus:""},e=await q(d);e.data.success&&(c.value=e.data.result,h.value=!0)}return oe(()=>r.value,()=>{v.name==="supplier-order"&&(r.value.orderType="PURCHASE"),v.name==="supplier-proxy-order"&&(r.value.isProxy=!0),A(),N()},{deep:!0,immediate:!0}),(d,e)=>{const l=i("a-tab-pane"),$=i("a-tabs"),w=i("a-button"),M=i("a-space"),U=i("a-col"),V=i("a-row"),k=i("a-typography-text"),B=i("a-tooltip"),F=i("a-image"),K=i("a-card");return _(),re(K,{class:"general-card",title:"商品订单",bordered:!1},{default:o(()=>[t($,{"default-active-key":a(b),onChange:e[0]||(e[0]=s=>{a(r).orderStatus=s==="ALL"?"":s})},{default:o(()=>[t(l,{key:"ALL",title:"全部"}),t(l,{key:"UNPAID",title:`待支付（${a(c).unPaidOrder}）`},null,8,["title"]),t(l,{key:"UNDELIVERED",title:`待发货（${a(c).unDeliveredOrder}）`},null,8,["title"]),t(l,{key:"TAKE",title:`待核验（${a(c).unTakeOrder}）`},null,8,["title"]),t(l,{key:"STAY_PICKED_UP",title:`待自提（${a(c).unPickUpOrder}）`},null,8,["title"]),t(l,{key:"PARTS_DELIVERED",title:`部分发货（${a(c).partsDeliveredOrder}）`},null,8,["title"]),t(l,{key:"DELIVERED",title:`待收货（${a(c).deliveredOrder}）`},null,8,["title"]),t(l,{key:"AFTER_SALE",title:`售后中（${a(c).afterSaleOrder}）`},null,8,["title"]),t(l,{key:"COMPLETED",title:"已完成"}),t(l,{key:"CANCELLED",title:"已关闭"})]),_:1},8,["default-active-key"]),t(a(ee),{ref_key:"pickSearchColumnRef",ref:E,columns:I,onReset:e[1]||(e[1]=s=>{r.value={...a(r),...s}}),onSearch:e[2]||(e[2]=s=>{r.value={...a(r),...s}})},null,512),t(V,{"mb-16px":""},{default:o(()=>[t(U,{span:16},{default:o(()=>[t(M,null,{default:o(()=>[t(w,{type:"primary",onClick:R},{default:o(()=>e[5]||(e[5]=[m(" 导出订单 ")])),_:1})]),_:1})]),_:1})]),_:1}),t(a(te),{ref_key:"tablePageRef",ref:S,columns:L,methods:C,"data-list":a(g),total:a(x).total,bordered:!0,"custom-col":!0,colspan:8,onPaginationChange:e[3]||(e[3]=s=>{r.value={...a(r),...s}}),onOrderDetail:e[4]||(e[4]=s=>{d.$openWindow({name:"order-detail",query:{id:s.record.sn}})})},{full:o(({data:s})=>[n("div",ce,[n("p",pe,[e[6]||(e[6]=m(" 订单编号： ")),t(k,{copyable:"",bold:""},{default:o(()=>[n("span",me,f(s.sn),1)]),_:2},1024)]),n("p",fe,[e[7]||(e[7]=m(" 下单时间：")),n("span",_e,f(s.createTime),1)]),s.afterSaleApplying?(_(),y("p",ye,[t(B,{content:"点击跳转至售后列表查看相关售后"},{default:o(()=>[t(w,{type:"primary",onClick:u=>a(le).push(`/after-sale?orderSn=${s.sn}`)},{default:o(()=>e[8]||(e[8]=[m(" 售后中 ")])),_:2},1032,["onClick"])]),_:2},1024)])):T("",!0)])]),goods:o(({data:s})=>[(_(!0),y(ne,null,de(s.orderItems,(u,H)=>(_(),y("div",{key:H,class:"flex","mb-5px":""},[t(F,{width:"50",height:"50",src:u.image,"show-loader":""},{loader:o(()=>e[9]||(e[9]=[n("div",{class:"loader-animate"},null,-1)])),_:2},1032,["src"]),n("div",be,[t(k,{copyable:"",bold:""},{default:o(()=>[m(f(u.name),1)]),_:2},1024),n("div",ke,[u!=null&&u.goodsUnit?(_(),y("div",ve,[t(k,{style:{"font-size":"12px"},type:"secondary"},{default:o(()=>[m(f(u.goodsUnit),1)]),_:2},1024)])):T("",!0)])]),n("div",he,[n("span",ge,f(a(Y)(u.goodsPrice,"￥")),1),n("span",xe," x"+f(u.num),1)])]))),128))]),_:1},8,["data-list","total"])]),_:1})}}}),Le=ue(Oe,[["__scopeId","data-v-4e95a2c1"]]);export{Le as default};
