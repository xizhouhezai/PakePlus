import{B as k,C as I}from"./operation-CQQGRn8-.js";import{u as v}from"./useCurrentInstance-BLlvmEjv.js";import{K as d,L as i}from"./tools-BfzgO_2s.js";import{U as L,V as N}from"./dist-PezRi_EG.js";import{d as P,r as c,h as E,b as m,o as u,j as p,w as l,e as f,u as a,f as M,s as T,M as V,_ as D}from"./index-C4AMdMz2.js";const S=P({__name:"exportLog",setup(B){var n;const b=(n=v().globalProperties)==null?void 0:n.$modal,r=c(),s=c({}),x=[{label:"导出类型",model:"type",disabled:!1,select:{options:d}},{label:"导出状态",model:"status",disabled:!1,select:{options:i}},{label:"操作店铺",model:"storeName",disabled:!1,input:!0},{label:"导出时间",disabled:!1,datePicker:{type:"range"}}],g=[{title:"文件名称",dataIndex:"fileName",width:240},{title:"操作人",dataIndex:"operator",width:240},{title:"导出时间",dataIndex:"createTime",width:240},{title:"导出类型",dataIndex:"type",width:240,slot:!0,slotData:{badge:d}},{title:"导出状态",dataIndex:"status",width:240,slot:!0,slotData:{badge:i}},{title:"店铺名称",dataIndex:"storeName",width:240,slot:!0,store:!0}],_={title:"操作",width:200,fixed:"right",methods:[{title:"下载",callback:"details",slot:!0,slotTemplate:"details"},{title:"删除",callback:"delete",type:"text",status:"danger"}]};async function y(o){b.confirm({title:"确认删除",content:"您确认删除此记录?",alignCenter:!1,onOk:async()=>{(await I({exportLogsIds:o.record.id})).data.success&&(V.success("删除成功"),r.value.init())}})}async function h(o){const e=document.createElement("a");e.href=o.url,e.download=o.fileName,e.style.display="none",document.body.appendChild(e),e.click(),document.body.removeChild(e)}return E(()=>{}),(o,e)=>{const C=m("a-button"),w=m("a-card");return u(),p(w,{class:"general-card",title:"导出记录",bordered:!1},{default:l(()=>[f(a(L),{columns:x,onReset:e[0]||(e[0]=t=>{s.value={...a(s),...t}}),onSearch:e[1]||(e[1]=t=>{s.value={...a(s),...t}})}),f(a(N),{ref_key:"tablePageRef",ref:r,columns:g,methods:_,api:a(k),"api-params":a(s),bordered:!0,onDelete:y},{details:l(({data:t})=>[t.status==="COMPLETE"&&t.url?(u(),p(C,{key:0,type:"text",status:"success",onClick:R=>h(t)},{default:l(()=>e[2]||(e[2]=[M(" 下载 ")])),_:2},1032,["onClick"])):T("",!0)]),_:1},8,["api","api-params"])]),_:1})}}}),K=D(S,[["__scopeId","data-v-9b6f0057"]]);export{K as default};
