import{d as h,r as p,a as v,b as d,o as C,c as k,e as s,w as r,u as e,f as D,M as R,g as S}from"./index-C4AMdMz2.js";import{u as U}from"./useCurrentInstance-BLlvmEjv.js";import{u as M}from"./user-CppB_Ihe.js";import{R as f,P as w}from"./validator-B8pIxTAL.js";import{C as c}from"./index-DUU-x9KJ.js";import"./index-Cwm13-Rt.js";import"./goods-CB7YWqUH.js";const J=h({__name:"index",setup(E){var u;const{logout:_}=M(),P=(u=U().globalProperties)==null?void 0:u.$modal,i=p(),g=p(!1),a=v({oldPass:"",newPassword:"",rePass:""});async function y(){var o;if(!await((o=i.value)==null?void 0:o.validate())){if(a.rePass!==a.newPassword){R.error("两次输入密码不一致");return}const l={password:c.MD5(a.oldPass).toString(),newPassword:c.MD5(a.newPassword).toString()},t=new FormData;t.append("password",l.password),t.append("newPassword",l.newPassword),S(t).then(m=>{m.data.success&&P.confirm({title:"修改密码成功",content:"修改密码成功，需重新登录",onOk:async()=>{_("login","no-redirect")}})})}}return(V,o)=>{const l=d("a-input-password"),t=d("a-form-item"),m=d("a-button"),b=d("a-form"),x=d("a-card");return C(),k("div",null,[s(x,{title:"修改密码",bordered:!1},{default:r(()=>[s(b,{ref_key:"formRef",ref:i,model:e(a),style:{width:"600px"}},{default:r(()=>[s(t,{label:"原密码","validate-trigger":"input",required:""},{default:r(()=>[s(l,{modelValue:e(a).oldPass,"onUpdate:modelValue":o[0]||(o[0]=n=>e(a).oldPass=n),style:{width:"320px"},placeholder:"请输入现在使用的密码","allow-clear":""},null,8,["modelValue"])]),_:1}),s(t,{label:"新密码",field:"newPassword",rules:[e(f),e(w)]},{default:r(()=>[s(l,{modelValue:e(a).newPassword,"onUpdate:modelValue":o[1]||(o[1]=n=>e(a).newPassword=n),style:{width:"320px"},placeholder:"请输入新密码","allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),s(t,{label:"确认新密码",field:"rePass","validate-trigger":"input",rules:[e(f),e(w)]},{default:r(()=>[s(l,{modelValue:e(a).rePass,"onUpdate:modelValue":o[2]||(o[2]=n=>e(a).rePass=n),style:{width:"320px"},placeholder:"请再次输入新密码","allow-clear":""},null,8,["modelValue"])]),_:1},8,["rules"]),s(t,{label:"操作"},{default:r(()=>[s(m,{loading:e(g),"html-type":"submit",type:"primary",onClick:y},{default:r(()=>o[3]||(o[3]=[D(" 保存 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1})])}}});export{J as default};
