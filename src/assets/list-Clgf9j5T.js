import{t as N,v as R}from"./promotion-ChRoyrm_.js";import{u as V}from"./useCurrentInstance-BLlvmEjv.js";import{ah as d}from"./tools-BfzgO_2s.js";import{U as D,V as I}from"./dist-PezRi_EG.js";import{d as P,n as $,r as p,b as c,o as f,j as b,w as s,e as r,u as a,f as n,t as k,k as h,s as B,M}from"./index-C4AMdMz2.js";const j=P({__name:"list",setup(A){var u;const g=(u=V().globalProperties)==null?void 0:u.$modal,S=$(),m=p(),l=p({sort:"createTime"}),T=[{label:"活动名称",model:"promotionName",disabled:!1,input:!0},{label:"活动状态",model:"promotionStatus",disabled:!1,select:{options:d}},{label:"活动时间",model:"selectDate",disabled:!1,datePicker:{type:"range"}}],v=[{title:"活动名称",dataIndex:"promotionName",width:250},{title:"优惠信息",dataIndex:"title",width:250},{title:"活动时间",dataIndex:"time",width:400,slot:!0,slotTemplate:"time"},{title:"活动状态",dataIndex:"promotionStatus",slot:!0,slotData:{badge:d}}],x={title:"操作",width:200,methods:[{title:"查看",callback:"view",slot:!0,slotTemplate:"view"},{title:"关闭",callback:"close",slot:!0,slotTemplate:"close"}]};function C(o){S.push({name:"full-discount-detail",query:{id:o.id}})}function y(o){let t="开启";(o.promotionStatus==="START"||o.promotionStatus==="NEW")&&(t="关闭"),g.confirm({title:"提示",content:`确认${t}此活动吗?需要一定时间才能生效，请耐心等待`,alignCenter:!1,onOk:async()=>{(await R(o.id)).data.success&&(M.success(`${t}成功`),m.value.init())}})}return(o,t)=>{const i=c("a-button"),w=c("a-card");return f(),b(w,{class:"general-card",title:"多件优惠",bordered:!1},{default:s(()=>[r(a(D),{columns:T,"time-type":"timestamp",onReset:t[0]||(t[0]=e=>{l.value={...a(l),...e}}),onSearch:t[1]||(t[1]=e=>{l.value={...a(l),...e}})}),r(a(I),{ref_key:"tablePageRef",ref:m,columns:v,methods:x,api:a(N),"api-params":a(l),bordered:!0},{time:s(({data:e})=>[n(k(e.startTime),1),t[2]||(t[2]=h("span",{style:{margin:"0 10px"}},"-",-1)),n(k(e.endTime),1)]),view:s(({data:e})=>[r(i,{type:"text",status:"success",onClick:_=>C(e)},{default:s(()=>t[3]||(t[3]=[n(" 查看 ")])),_:2},1032,["onClick"])]),close:s(({data:e})=>[e.promotionStatus==="NEW"||e.promotionStatus==="START"?(f(),b(i,{key:0,type:"text",status:"danger",onClick:_=>y(e)},{default:s(()=>t[4]||(t[4]=[n(" 关闭 ")])),_:2},1032,["onClick"])):B("",!0)]),_:1},8,["api","api-params"])]),_:1})}}});export{j as default};
