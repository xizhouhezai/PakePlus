import{a as V,a5 as D}from"./promotion-ChRoyrm_.js";import{u as W}from"./useCurrentInstance-BLlvmEjv.js";import{ah as A}from"./tools-BfzgO_2s.js";import{U as B,V as F}from"./dist-PezRi_EG.js";import{d as M,r as f,n as O,b as d,o as l,j as r,w as s,e as o,u as a,c as q,F as U,i as j,f as i,t as z,s as y,M as G,_ as H}from"./index-C4AMdMz2.js";import J from"./seckill-setup-QpHl_CHq.js";const K=M({__name:"list",setup(Q){var C;const x=(C=W().globalProperties)==null?void 0:C.$modal,k=f(!1),b=f(),S=O(),g=f("START"),u=f({sort:"createTime",promotionStatus:g.value}),T=[{label:"活动名称",model:"promotionName",disabled:!1,input:!0},{label:"活动时间",model:"selectDate",disabled:!1,datePicker:{type:"range"}}],N=[{title:"活动名称",dataIndex:"promotionName"},{title:"活动开始时间",dataIndex:"startTime"},{title:"报名截止时间",dataIndex:"applyEndTime"},{title:"时间场次",dataIndex:"hours",slot:!0,width:300,ellipsis:!1,slotTemplate:"hours"},{title:"状态",dataIndex:"promotionStatus",slot:!0,slotData:{badge:A}}],E={title:"操作",width:240,methods:[{slot:!0,slotTemplate:"btnList"}]};function I(n){n==="setup"?k.value=!0:k.value=!1}function R(n){S.push({name:"manager-seckill-add",query:{id:n.id}})}function _(n){S.push({name:"seckill-goods",query:{id:n.id}})}function w(n){x.confirm({title:"提示",content:"您确定要下架该活动吗？",alignCenter:!1,onOk:async()=>{(await D(n.id)).data.success&&(G.success("删除成功！"),b.value.init())}})}return(n,t)=>{const m=d("a-tab-pane"),v=d("a-tabs"),L=d("a-tag"),c=d("a-button"),P=d("a-card");return l(),r(P,{class:"general-card",title:"秒杀活动",bordered:!1},{default:s(()=>[o(v,{"default-active-key":a(g),onChange:t[0]||(t[0]=e=>{a(u).promotionStatus=e})},{default:s(()=>[o(m,{key:"NEW",title:"未开始"}),o(m,{key:"START",title:"已开始"}),o(m,{key:"END",title:"已结束"}),o(m,{key:"CLOSE",title:"已关闭"})]),_:1},8,["default-active-key"]),o(a(B),{columns:T,"time-type":"timestamp",onReset:t[1]||(t[1]=e=>{u.value={...a(u),...e}}),onSearch:t[2]||(t[2]=e=>{u.value={...a(u),...e}})}),o(v,{"default-active-key":"list",onChange:I},{default:s(()=>[o(m,{key:"list",title:"秒杀活动列表"},{default:s(()=>[o(a(F),{ref_key:"tablePageRef",ref:b,columns:N,methods:E,api:a(V),"api-params":a(u),bordered:!0},{hours:s(({record:e})=>[(l(!0),q(U,null,j(e.split(","),(p,$)=>(l(),r(L,{key:$,class:"item-hour"},{default:s(()=>[i(z(`${p}:00`),1)]),_:2},1024))),128))]),btnList:s(({data:e})=>[e.promotionStatus==="CLOSE"||e.promotionStatus==="NEW"?(l(),r(c,{key:0,type:"text",status:"warning",onClick:p=>R(e)},{default:s(()=>t[3]||(t[3]=[i(" 编辑 ")])),_:2},1032,["onClick"])):(l(),r(c,{key:1,type:"text",status:"success",onClick:p=>_(e)},{default:s(()=>t[4]||(t[4]=[i(" 查看 ")])),_:2},1032,["onClick"])),t[7]||(t[7]=i("   ")),(e==null?void 0:e.promotionStatus)==="NEW"?(l(),r(c,{key:2,type:"text",status:"success",onClick:p=>_(e)},{default:s(()=>t[5]||(t[5]=[i(" 管理 ")])),_:2},1032,["onClick"])):y("",!0),t[8]||(t[8]=i("   ")),e.promotionStatus==="START"||e.promotionStatus==="NEW"?(l(),r(c,{key:3,type:"text",status:"danger",onClick:p=>w(e)},{default:s(()=>t[6]||(t[6]=[i(" 关闭 ")])),_:2},1032,["onClick"])):y("",!0),t[9]||(t[9]=i("   "))]),_:1},8,["api","api-params"])]),_:1}),o(m,{key:"setup",title:"秒杀活动设置"},{default:s(()=>[a(k)?(l(),r(J,{key:0})):y("",!0)]),_:1})]),_:1})]),_:1})}}}),st=H(K,[["__scopeId","data-v-cb22f457"]]);export{st as default};
