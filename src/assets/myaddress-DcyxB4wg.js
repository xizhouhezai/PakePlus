import{d as q,r as m,p as S,h as H,b as r,o as A,c as J,k as x,e as l,w as s,f,u as a,t as T,j as $,ag as z,q as F,M as I,_ as L}from"./index-C4AMdMz2.js";import{l as Q,n as G,o as K,r as W}from"./member-B0DkAxtf.js";import{u as X}from"./useCurrentInstance-BLlvmEjv.js";import{R as p,V as Y,M as Z}from"./validator-B8pIxTAL.js";import{V as ee,n as ae}from"./dist-PezRi_EG.js";const te={class:"add"},le={style:{"text-align":"right"}},se=q({__name:"myaddress",setup(de){var y;const b=m(1),_=m(),M=(y=X().globalProperties)==null?void 0:y.$modal,v=m(),i=m(!1),g=S(),R=m(""),t=m({name:"",isDefault:!1,alias:"",detail:"",consigneeAddressPath:"",mobile:"",center:"",id:"",consigneeAddressIdPath:""});H(()=>{R.value=g.query.id});const k=[{title:"地址别名",dataIndex:"alias"},{title:"收货人姓名",dataIndex:"name"},{title:"收货人电话",dataIndex:"mobile"},{title:"地址",dataIndex:"consigneeAddressPath"},{title:"详细地址",dataIndex:"detail"}],C={extendId:g.query.id,scene:"MEMBER",sort:"",order:""};function E(){b.value=1,_.value.resetFields(),t.value.isDefault=!1,delete t.value.id,i.value=!0}function D(o){t.value.consigneeAddressPath=o.cities.join(","),t.value.consigneeAddressIdPath=o.ids.join(",")}function P(o){b.value+=1,o&&(Object.keys(o.record).forEach(e=>{t.value[e]=o.record[e]}),t.value.id=o.record.id),i.value=!0}async function w(){var e;if(!await((e=_.value)==null?void 0:e.validate())){const d=JSON.parse(JSON.stringify(t.value));d.isDefault=d.isDefault==="1",d.type="RECEIVE",d.scene="MEMBER",d.extendId=g.query.id,(d.id?await G(d):await K(d)).data.code===200&&(I.success(`${d.id?"修改":"新增"}成功`),v.value.init(),i.value=!1)}}function h(){i.value=!1}const B={title:"操作",width:200,fixed:"right",methods:[{title:"删除",callback:"deleteAddress"},{title:"编辑",callback:"editAddress"}]};function U(o){M.confirm({title:"删除",content:"确定要删除此收货地址？",alignCenter:!1,onOk:async()=>{(await W(o.record.id)).data.success&&(I.success("删除成功"),v.value.init())}})}return(o,e)=>{const d=r("a-button"),c=r("a-input"),u=r("a-form-item"),V=r("a-radio"),O=r("a-radio-group"),N=r("a-form"),j=r("a-modal");return A(),J("div",null,[x("div",te,[l(d,{type:"primary",onClick:E},{default:s(()=>e[6]||(e[6]=[f(" 新增 ")])),_:1})]),l(a(ee),{ref_key:"tablePageRef",ref:v,"api-params":C,columns:k,api:a(Q),methods:B,onDeleteAddress:U,onEditAddress:P},null,8,["api"]),l(j,{visible:a(i),"onUpdate:visible":e[5]||(e[5]=n=>F(i)?i.value=n:null),width:700},{title:s(()=>[f(T(a(t).id?"修改":"新增")+"会员地址 ",1)]),footer:s(()=>[x("div",le,[l(d,{onClick:h},{default:s(()=>e[9]||(e[9]=[f(" 取消 ")])),_:1}),l(d,{style:{"margin-left":"10px"},type:"primary",onClick:w},{default:s(()=>e[10]||(e[10]=[f(" 保存 ")])),_:1})])]),default:s(()=>[l(N,{ref_key:"formRef",ref:_,model:a(t),style:{width:"460px"},layout:"horizontal","auto-label-width":""},{default:s(()=>[l(u,{field:"name",label:"收货人姓名",rules:[a(p),a(Y)]},{default:s(()=>[l(c,{modelValue:a(t).name,"onUpdate:modelValue":e[0]||(e[0]=n=>a(t).name=n)},null,8,["modelValue"])]),_:1},8,["rules"]),l(u,{field:"mobile",label:"收货人手机",rules:[a(p),a(Z)]},{default:s(()=>[l(c,{modelValue:a(t).mobile,"onUpdate:modelValue":e[1]||(e[1]=n=>a(t).mobile=n),"max-length":11},null,8,["modelValue"])]),_:1},8,["rules"]),l(u,{field:"consigneeAddressPath",label:"收货人地址",rules:[a(p)]},{default:s(()=>[(A(),$(a(ae),{key:a(b),api:a(z),ids:a(t).consigneeAddressIdPath,address:a(t).consigneeAddressPath,onCallback:D},null,8,["api","ids","address"]))]),_:1},8,["rules"]),l(u,{field:"detail",label:"详细地址",rules:[a(p)]},{default:s(()=>[l(c,{modelValue:a(t).detail,"onUpdate:modelValue":e[2]||(e[2]=n=>a(t).detail=n)},null,8,["modelValue"])]),_:1},8,["rules"]),l(u,{field:"alias",label:"地址别名",rules:[a(p)]},{default:s(()=>[l(c,{modelValue:a(t).alias,"onUpdate:modelValue":e[3]||(e[3]=n=>a(t).alias=n)},null,8,["modelValue"])]),_:1},8,["rules"]),l(u,{label:"默认"},{default:s(()=>[l(O,{modelValue:a(t).isDefault,"onUpdate:modelValue":e[4]||(e[4]=n=>a(t).isDefault=n),type:"button"},{default:s(()=>[l(V,{value:!0},{default:s(()=>e[7]||(e[7]=[f(" 是 ")])),_:1}),l(V,{value:!1},{default:s(()=>e[8]||(e[8]=[f(" 否 ")])),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"])])}}}),me=L(se,[["__scopeId","data-v-72d12fe5"]]);export{me as default};
