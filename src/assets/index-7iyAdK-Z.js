import{d as ee,r as f,a as S,E as te,b as s,o as g,j as y,w as a,e as o,u as l,q as R,f as d,bB as ae,t as oe,k as m,s as k,bC as le,bD as ne,M as D,bE as re}from"./index-C4AMdMz2.js";import{_ as se}from"./index.vue_vue_type_script_setup_true_lang-DsrWKjKu.js";import{u as de}from"./useCurrentInstance-BLlvmEjv.js";import{R as $,V as ie}from"./validator-B8pIxTAL.js";import{V as ue}from"./dist-PezRi_EG.js";import"./index-CzBKN9cw.js";import"./index--a7kHzzJ.js";import"./extra-5DUayDl9.js";const me=["src"],fe={"w-full":""},pe={"mt-10px":""},ce=["src"],_e={style:{"text-align":"right"}},Ce=ee({__name:"index",setup(be){var O;const p=f("RESOURCE"),c=f(!1),i=f(!1),w=f(),C=f(),B=(O=de().globalProperties)==null?void 0:O.$modal,b=f(),x=f(""),P=[{title:"名称",dataIndex:"name"},{title:"图片",dataIndex:"resource",slot:!0,slotTemplate:"resource"},{title:"创建人",dataIndex:"createBy"},{title:"创建时间",dataIndex:"createTime"},{title:"最后修改人",dataIndex:"updateBy"},{title:"更新时间",dataIndex:"updateTime"}],T={title:"操作",width:250,methods:[{title:"编辑",callback:"update",type:"text",status:"warning"},{title:"删除",callback:"delete",type:"text",status:"danger"}]},E=S({type:p,order:"desc"});te(p,r=>{E.type=r,b.value.init()});const t=S({enableAddModal:!1,formLoading:!1,fid:"",form:{name:"",resource:"",type:"RESOURCE"}});function L(r){x.value="添加",t.enableAddModal=!0,t.form.name="",t.fid="",t.form.type=r,t.form.resource=""}function N(r){x.value="编辑",r&&(Object.keys(r.record).forEach(e=>{t.form.hasOwnProperty(e)&&(t.form[e]=r.record[e])}),t.fid=r.record.id,t.form.id=r.record.id,t.enableAddModal=!0)}async function j(){var e;if(!await((e=C.value)==null?void 0:e.validate())){let u;t.fid?u=await ne(t.fid,t.form):u=await le(t.form),u.data.success&&(D.success(`${t.fid?"修改":"添加"}成功!`),t.enableAddModal=!1,b.value.init())}}function q(r){B.confirm({title:"确认删除",content:"确认要删除此验证码源",alignCenter:!1,onOk:async()=>{(await re(r.record.id)).data.success&&(D.success("删除成功！"),b.value.init())}})}function G(){i.value=!1}function H(){i.value=!1}function Q(){i.value=!0}function z(){i.value=!1,t.form.resource=w.value}function F(r){w.value=r.url}return(r,e)=>{const u=s("a-radio"),U=s("a-radio-group"),I=s("a-row"),_=s("a-button"),J=s("a-space"),K=s("a-col"),A=s("a-alert"),W=s("a-image"),M=s("a-input"),v=s("a-form-item"),X=s("icon-eye"),Y=s("a-tooltip"),Z=s("a-form"),V=s("a-modal"),h=s("a-card");return g(),y(h,{class:"general-card",title:"验证码设置",bordered:!1},{default:a(()=>[o(I,{style:{"margin-bottom":"16px"}},{default:a(()=>[o(U,{modelValue:l(p),"onUpdate:modelValue":e[0]||(e[0]=n=>R(p)?p.value=n:null),type:"button"},{default:a(()=>[o(u,{value:"RESOURCE"},{default:a(()=>e[11]||(e[11]=[d(" 图片源 ")])),_:1}),o(u,{value:"SLIDER"},{default:a(()=>e[12]||(e[12]=[d(" 滑块源 ")])),_:1})]),_:1},8,["modelValue"])]),_:1}),o(I,{style:{"margin-bottom":"16px"}},{default:a(()=>[o(K,{span:16,style:{"margin-bottom":"10px"}},{default:a(()=>[o(J,null,{default:a(()=>[o(_,{type:"primary",onClick:e[1]||(e[1]=n=>L(l(p)))},{default:a(()=>e[13]||(e[13]=[d(" 添加 ")])),_:1})]),_:1})]),_:1}),o(A,{type:"error","mb-10px":""},{default:a(()=>e[14]||(e[14]=[d(" 图片源上传尺寸严格要求为：300px * 150px ")])),_:1}),o(l(ue),{ref_key:"tablePageRef",ref:b,columns:P,methods:T,api:l(ae),"api-params":l(E),bordered:!0,onDelete:q,onUpdate:N},{resource:a(({data:n})=>[o(W,{width:"50",height:"50",src:n.resource},null,8,["src"])]),_:1},8,["api","api-params"])]),_:1}),o(V,{visible:l(t).enableAddModal,"onUpdate:visible":e[6]||(e[6]=n=>l(t).enableAddModal=n),"align-center":!1,footer:!1},{title:a(()=>[d(oe(l(x)),1)]),default:a(()=>[o(Z,{ref_key:"formRef",ref:C,model:l(t).form,onSubmit:j},{default:a(()=>[o(v,{field:"name",label:"名称",rules:[l($),l(ie)],"validate-trigger":["change"]},{default:a(()=>[o(M,{modelValue:l(t).form.name,"onUpdate:modelValue":e[2]||(e[2]=n=>l(t).form.name=n)},null,8,["modelValue"])]),_:1},8,["rules"]),o(v,{field:"resource",label:"图片",rules:[l($)],"validate-trigger":["change"],"validate-phone":""},{default:a(()=>[o(M,{modelValue:l(t).form.resource,"onUpdate:modelValue":e[3]||(e[3]=n=>l(t).form.resource=n)},null,8,["modelValue"]),o(Y,null,{content:a(()=>[m("div",null,[m("img",{src:l(t).form.resource,alt:"该资源不存在",style:{width:"100%",margin:"0 auto"}},null,8,me),m("a",{style:{"margin-top":"5px","text-align":"right",cursor:"pointer"},onClick:e[4]||(e[4]=n=>c.value=!0)},"查看大图")])]),default:a(()=>[l(t).form.resource?(g(),y(_,{key:0},{default:a(()=>[o(X)]),_:1})):k("",!0)]),_:1}),o(_,{type:"primary",onClick:Q},{default:a(()=>e[15]||(e[15]=[d(" 上传图片 ")])),_:1})]),_:1},8,["rules"]),o(v,{field:"type",label:"类型"},{default:a(()=>[m("div",fe,[m("div",null,[o(U,{modelValue:l(t).form.type,"onUpdate:modelValue":e[5]||(e[5]=n=>l(t).form.type=n),type:"button"},{default:a(()=>[o(u,{value:"RESOURCE"},{default:a(()=>e[16]||(e[16]=[d(" 图片源 ")])),_:1}),o(u,{value:"SLIDER"},{default:a(()=>e[17]||(e[17]=[d(" 滑块源 ")])),_:1})]),_:1},8,["modelValue"])]),m("div",pe,[l(t).form.type==="SLIDER"?(g(),y(A,{key:0},{default:a(()=>e[18]||(e[18]=[d(" 上传图片为PNG格式，滑块源上传的图片尺寸不得超过任何图片源的最小尺寸。 ")])),_:1})):k("",!0)])])]),_:1}),o(v,{label:"操作"},{default:a(()=>[o(_,{loading:l(t).formLoading,"html-type":"submit",type:"primary"},{default:a(()=>e[19]||(e[19]=[d(" 保存 ")])),_:1},8,["loading"])]),_:1})]),_:1},8,["model"])]),_:1},8,["visible"]),o(V,{visible:l(i),"onUpdate:visible":e[7]||(e[7]=n=>R(i)?i.value=n:null),width:1100,title:"oss资源管理",onOk:z,onCancel:e[8]||(e[8]=n=>i.value=!1)},{default:a(()=>[l(t).enableAddModal?(g(),y(se,{key:0,"is-single":!0,onSelected:F})):k("",!0)]),_:1},8,["visible"]),o(V,{visible:l(c),"onUpdate:visible":e[10]||(e[10]=n=>R(c)?c.value=n:null),width:1100,title:"查看图片",onOk:G,onCancel:H},{footer:a(()=>[m("div",_e,[o(_,{type:"text",onClick:e[9]||(e[9]=n=>c.value=!1)},{default:a(()=>e[20]||(e[20]=[d(" 关闭 ")])),_:1})])]),default:a(()=>[m("img",{src:l(t).form.resource,alt:"该资源不存在",style:{width:"100%",margin:"0 auto",display:"block"}},null,8,ce)]),_:1},8,["visible"])]),_:1})}}});export{Ce as default};
