import{B,C as X,D as G}from"./goods-CB7YWqUH.js";import{u as L}from"./useCurrentInstance-BLlvmEjv.js";import{R as $}from"./validator-B8pIxTAL.js";import{V as j}from"./dist-PezRi_EG.js";import{d as H,r as u,a as Q,b as n,o as h,j as C,w as s,e as l,u as a,f,t as T,k as W,s as q,M as k,_ as z}from"./index-C4AMdMz2.js";const F=H({__name:"index",setup(J){var V;const m=u(),p=u(),c=(V=L().globalProperties)==null?void 0:V.$modal,g=u(""),w=u({}),t=Q({enableAddModal:!1,formLoading:!1,fid:"",form:{id:"",tagName:"",tagDesc:"",tagPosition:"",tagType:"",days:0,sort:0,status:!0}}),_=[{label:"标题前",value:"above"},{label:"标题下",value:"below"}],I=[{title:"标签名称",dataIndex:"tagName"},{title:"标签说明",dataIndex:"tagDesc"},{title:"标签位置",dataIndex:"tagPosition",slot:!0,slotTemplate:"position"},{title:"标签生效设置",dataIndex:"days"},{title:"排序",dataIndex:"sort"},{title:"状态",dataIndex:"status",slot:!0,slotTemplate:"status"}],b={NEW:"商品通过审核后 X 天内，展示此标签",HOT:"最近30天销量大于 X 件，展示此标签",SELL:"最近30天用户评论数大于 X 条，展示此标签",CHOICE:"最近30天用户好评率大于 X 时，展示此标签"},M={title:"操作",width:100,fixed:"right",methods:[{title:"编辑",callback:"editor",type:"text",status:"warning"}]};function P(d){g.value="编辑",Object.keys(t.form).forEach(e=>{d.record[e]&&(t.form[e]=d.record[e])}),t.fid=d.record.id,t.enableAddModal=!0}async function E(){var e;await((e=p.value)==null?void 0:e.validate())||c.confirm({title:"确认修改",content:"修改需在第二天才会生效, 您确认要修改当前数据吗?",alignCenter:!1,onOk:async()=>{X(t.form).then(()=>{k.success("操作成功!"),t.enableAddModal=!1,m.value.init()})}})}async function U(d){c.confirm({title:"确认修改状态",content:"修改状态需在第二天才会生效, 您确认要修改当前数据状态吗?",alignCenter:!1,onOk:async()=>{G({ids:d.id,status:d.status}).then(()=>{k.success("操作成功"),m.value.init()})}}),m.value.init()}return(d,e)=>{const v=n("a-switch"),y=n("a-input-number"),i=n("a-form-item"),A=n("a-select"),x=n("a-button"),D=n("a-space"),N=n("a-form"),O=n("a-modal"),R=n("a-card");return h(),C(R,{class:"general-card",bordered:!1},{default:s(()=>[l(a(j),{ref_key:"tablePageRef",ref:m,columns:I,methods:M,api:a(B),"api-params":a(w),bordered:!0,onEditor:P},{position:s(({data:o})=>{var r;return[f(T((r=_.find(S=>S.value===o.tagPosition))==null?void 0:r.label),1)]}),status:s(({data:o})=>[l(v,{modelValue:o.status,"onUpdate:modelValue":r=>o.status=r,onChange:r=>U(o)},null,8,["modelValue","onUpdate:modelValue","onChange"])]),_:1},8,["api","api-params"]),l(O,{visible:a(t).enableAddModal,"onUpdate:visible":e[5]||(e[5]=o=>a(t).enableAddModal=o),title:a(g),footer:!1,"mask-closable":!1,width:500},{default:s(()=>[l(N,{ref_key:"formRef",ref:p,model:a(t).form,onSubmit:E},{default:s(()=>[b[a(t).form.tagType]?(h(),C(i,{key:0,field:"sort",label:"生效设置","validate-trigger":["change"]},{extra:s(()=>[W("div",null,T(b[a(t).form.tagType]),1)]),default:s(()=>[l(y,{modelValue:a(t).form.days,"onUpdate:modelValue":e[0]||(e[0]=o=>a(t).form.days=o),min:0,placeholder:"请输入"},null,8,["modelValue"])]),_:1})):q("",!0),l(i,{field:"position",label:"标签位置","validate-trigger":["change"]},{default:s(()=>[l(A,{modelValue:a(t).form.tagPosition,"onUpdate:modelValue":e[1]||(e[1]=o=>a(t).form.tagPosition=o),options:_,placeholder:"请选择标签位置"},null,8,["modelValue"])]),_:1}),l(i,{field:"sort",label:"排序",rules:[a($)],"validate-trigger":["change"]},{default:s(()=>[l(y,{modelValue:a(t).form.sort,"onUpdate:modelValue":e[2]||(e[2]=o=>a(t).form.sort=o),min:0,placeholder:"请输入排序值"},null,8,["modelValue"])]),_:1},8,["rules"]),l(i,{field:"status",label:"状态","validate-trigger":["change"]},{default:s(()=>[l(v,{modelValue:a(t).form.status,"onUpdate:modelValue":e[3]||(e[3]=o=>a(t).form.status=o)},null,8,["modelValue"])]),_:1}),l(i,null,{default:s(()=>[l(D,null,{default:s(()=>[l(x,{type:"primary","html-type":"submit"},{default:s(()=>e[6]||(e[6]=[f(" 确定 ")])),_:1}),l(x,{onClick:e[4]||(e[4]=o=>a(t).enableAddModal=!1)},{default:s(()=>e[7]||(e[7]=[f(" 取消 ")])),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["visible","title"])]),_:1})}}}),ae=z(F,[["__scopeId","data-v-c29d09fd"]]);export{ae as default};
